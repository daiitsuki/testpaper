import{c as Ai,g as xi,R as _n}from"./vendor-CDEvMqQ1.js";var Un={exports:{}},Ti=Un.exports,Wr;function ki(){return Wr||(Wr=1,(function(q,L){((P,N)=>{q.exports=N()})(Ti,function(){var P=function(e,t){return(P=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,r){n.__proto__=r}:function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])}))(e,t)},N=function(){return(N=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function $(e,t,n){for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||((r=r||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var k=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Ai,w=Object.keys,J=Array.isArray;function ce(e,t){return typeof t=="object"&&w(t).forEach(function(n){e[n]=t[n]}),e}typeof Promise>"u"||k.Promise||(k.Promise=Promise);var E=Object.getPrototypeOf,ee={}.hasOwnProperty;function te(e,t){return ee.call(e,t)}function qe(e,t){typeof t=="function"&&(t=t(E(e))),(typeof Reflect>"u"?w:Reflect.ownKeys)(t).forEach(function(n){be(e,n,t[n])})}var Qe=Object.defineProperty;function be(e,t,n,r){Qe(e,t,ce(n&&te(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function ge(e){return{from:function(t){return e.prototype=Object.create(t.prototype),be(e.prototype,"constructor",e),{extend:qe.bind(null,e.prototype)}}}}var Me=Object.getOwnPropertyDescriptor,_t=[].slice;function Xe(e,t,n){return _t.call(e,t,n)}function se(e,t){return t(e)}function pt(e){if(!e)throw new Error("Assertion Failed")}function me(e){k.setImmediate?setImmediate(e):setTimeout(e,0)}function xe(e,t){if(typeof t=="string"&&te(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],r=0,i=t.length;r<i;++r){var a=xe(e,t[r]);n.push(a)}return n}var u,l=t.indexOf(".");return l===-1||(u=e[t.substr(0,l)])==null?void 0:xe(u,t.substr(l+1))}function we(e,t,n){if(e&&t!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){pt(typeof n!="string"&&"length"in n);for(var r=0,i=t.length;r<i;++r)we(e,t[r],n[r])}else{var a,u,l=t.indexOf(".");l!==-1?(a=t.substr(0,l),(l=t.substr(l+1))===""?n===void 0?J(e)&&!isNaN(parseInt(a))?e.splice(a,1):delete e[a]:e[a]=n:we(u=(u=e[a])&&te(e,a)?u:e[a]={},l,n)):n===void 0?J(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function Ot(e){var t,n={};for(t in e)te(e,t)&&(n[t]=e[t]);return n}var j=[].concat;function f(e){return j.apply([],e)}var it="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(f([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return k[e]}),V=new Set(it.map(function(e){return k[e]})),B=null;function Te(e){return B=new WeakMap,e=(function t(n){if(!n||typeof n!="object")return n;var r=B.get(n);if(r)return r;if(J(n)){r=[],B.set(n,r);for(var i=0,a=n.length;i<a;++i)r.push(t(n[i]))}else if(V.has(n.constructor))r=n;else{var u,l=E(n);for(u in r=l===Object.prototype?{}:Object.create(l),B.set(n,r),n)te(n,u)&&(r[u]=t(n[u]))}return r})(e),B=null,e}var Se={}.toString;function Ue(e){return Se.call(e).slice(8,-1)}var Je=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ct=typeof Je=="symbol"?function(e){var t;return e!=null&&(t=e[Je])&&t.apply(e)}:function(){return null};function lt(e,t){t=e.indexOf(t),0<=t&&e.splice(t,1)}var ut={};function Ne(e){var t,n,r,i;if(arguments.length===1){if(J(e))return e.slice();if(this===ut&&typeof e=="string")return[e];if(i=ct(e))for(n=[];!(r=i.next()).done;)n.push(r.value);else{if(e==null)return[e];if(typeof(t=e.length)!="number")return[e];for(n=new Array(t);t--;)n[t]=e[t]}}else for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var He=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},it=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],_e=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(it),Dt={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ve(e,t){this.name=e,this.message=t}function ze(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,r,i){return i.indexOf(n)===r}).join(`
`)}function vt(e,t,n,r){this.failures=t,this.failedKeys=r,this.successCount=n,this.message=ze(e,t)}function I(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=ze(e,this.failures)}ge(ve).from(Error).extend({toString:function(){return this.name+": "+this.message}}),ge(vt).from(ve),ge(I).from(ve);var R=_e.reduce(function(e,t){return e[t]=t+"Error",e},{}),F=ve,A=_e.reduce(function(e,t){var n=t+"Error";function r(i,a){this.name=n,i?typeof i=="string"?(this.message="".concat(i).concat(a?`
 `+a:""),this.inner=a||null):typeof i=="object"&&(this.message="".concat(i.name," ").concat(i.message),this.inner=i):(this.message=Dt[t]||n,this.inner=null)}return ge(r).from(F),e[t]=r,e},{}),Q=(A.Syntax=SyntaxError,A.Type=TypeError,A.Range=RangeError,it.reduce(function(e,t){return e[t+"Error"]=A[t],e},{}));it=_e.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=A[t]),e},{});function ae(){}function Ee(e){return e}function Ce(e,t){return e==null||e===Ee?t:function(n){return t(e(n))}}function fe(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function mt(e,t){return e===ae?t:function(){var n=e.apply(this,arguments),r=(n!==void 0&&(arguments[0]=n),this.onsuccess),i=this.onerror,a=(this.onsuccess=null,this.onerror=null,t.apply(this,arguments));return r&&(this.onsuccess=this.onsuccess?fe(r,this.onsuccess):r),i&&(this.onerror=this.onerror?fe(i,this.onerror):i),a!==void 0?a:n}}function kt(e,t){return e===ae?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?fe(n,this.onsuccess):n),r&&(this.onerror=this.onerror?fe(r,this.onerror):r)}}function Ct(e,t){return e===ae?t:function(i){var r=e.apply(this,arguments),i=(ce(i,r),this.onsuccess),a=this.onerror,u=(this.onsuccess=null,this.onerror=null,t.apply(this,arguments));return i&&(this.onsuccess=this.onsuccess?fe(i,this.onsuccess):i),a&&(this.onerror=this.onerror?fe(a,this.onerror):a),r===void 0?u===void 0?void 0:u:ce(r,u)}}function Ft(e,t){return e===ae?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function It(e,t){return e===ae?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,i=arguments.length,a=new Array(i);i--;)a[i]=arguments[i];return n.then(function(){return t.apply(r,a)})}return t.apply(this,arguments)}}it.ModifyError=vt,it.DexieError=ve,it.BulkError=I;var dt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Pt(e){dt=e}var xt={},ot=100,De=typeof Promise>"u"?[]:(_e=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[De=crypto.subtle.digest("SHA-512",new Uint8Array([0])),E(De),_e]:[_e,E(_e),_e]),_e=De[0],cn=De[1],cn=cn&&cn.then,Ie=_e&&_e.constructor,tt=!!De[2],le=function(e,t){pe.push([e,t]),o&&(queueMicrotask(Oe),o=!1)},c=!0,o=!0,s=[],p=[],_=Ee,Y={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ae,pgp:!1,env:{},finalize:ae},C=Y,pe=[],Z=0,de=[];function D(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=C;if(typeof e!="function"){if(e!==xt)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Be(this,this._value)}else this._state=null,this._value=null,++t.ref,(function n(r,i){try{i(function(a){if(r._state===null){if(a===r)throw new TypeError("A promise cannot be resolved with itself.");var u=r._lib&&at();a&&typeof a.then=="function"?n(r,function(l,y){a instanceof D?a._then(l,y):a.then(l,y)}):(r._state=!0,r._value=a,Ke(r)),u&&ie()}},Be.bind(null,r))}catch(a){Be(r,a)}})(this,e)}var Ae={get:function(){var e=C,t=bt;function n(r,i){var a=this,u=!e.global&&(e!==C||t!==bt),l=u&&!Fe(),y=new D(function(S,v){Ge(a,new Ve(en(r,e,u,l),en(i,e,u,l),S,v,e))});return this._consoleTask&&(y._consoleTask=this._consoleTask),y}return n.prototype=xt,n},set:function(e){be(this,"then",e&&e.prototype===xt?Ae:{get:function(){return e},set:Ae.set})}};function Ve(e,t,n,r,i){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=r,this.psd=i}function Be(e,t){var n,r;p.push(t),e._state===null&&(n=e._lib&&at(),t=_(t),e._state=!1,e._value=t,r=e,s.some(function(i){return i._value===r._value})||s.push(r),Ke(e),n)&&ie()}function Ke(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)Ge(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),Z===0&&(++Z,le(function(){--Z==0&&z()},[]))}function Ge(e,t){if(e._state===null)e._listeners.push(t);else{var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Z,le(We,[n,e,t])}}function We(e,t,n){try{var r,i=t._value;!t._state&&p.length&&(p=[]),r=dt&&t._consoleTask?t._consoleTask.run(function(){return e(i)}):e(i),t._state||p.indexOf(i)!==-1||(a=>{for(var u=s.length;u;)if(s[--u]._value===a._value)return s.splice(u,1)})(t),n.resolve(r)}catch(a){n.reject(a)}finally{--Z==0&&z(),--n.psd.ref||n.psd.finalize()}}function Oe(){Vt(Y,function(){at()&&ie()})}function at(){var e=c;return o=c=!1,e}function ie(){var e,t,n;do for(;0<pe.length;)for(e=pe,pe=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}while(0<pe.length);o=c=!0}function z(){for(var e=s,t=(s=[],e.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)}),de.slice(0)),n=t.length;n;)t[--n]()}function he(e){return new D(xt,!1,e)}function X(e,t){var n=C;return function(){var r=at(),i=C;try{return yt(n,!0),e.apply(this,arguments)}catch(a){t&&t(a)}finally{yt(i,!1),r&&ie()}}}qe(D.prototype,{then:Ae,_then:function(e,t){Ge(this,new Ve(null,null,e,t,C))},catch:function(e){var t,n;return arguments.length===1?this.then(null,e):(t=e,n=arguments[1],typeof t=="function"?this.then(null,function(r){return(r instanceof t?n:he)(r)}):this.then(null,function(r){return(r&&r.name===t?n:he)(r)}))},finally:function(e){return this.then(function(t){return D.resolve(e()).then(function(){return t})},function(t){return D.resolve(e()).then(function(){return he(t)})})},timeout:function(e,t){var n=this;return e<1/0?new D(function(r,i){var a=setTimeout(function(){return i(new A.Timeout(t))},e);n.then(r,i).finally(clearTimeout.bind(null,a))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&be(D.prototype,Symbol.toStringTag,"Dexie.Promise"),Y.env=Kt(),qe(D,{all:function(){var e=Ne.apply(null,arguments).map(Et);return new D(function(t,n){e.length===0&&t([]);var r=e.length;e.forEach(function(i,a){return D.resolve(i).then(function(u){e[a]=u,--r||t(e)},n)})})},resolve:function(e){return e instanceof D?e:e&&typeof e.then=="function"?new D(function(t,n){e.then(t,n)}):new D(xt,!0,e)},reject:he,race:function(){var e=Ne.apply(null,arguments).map(Et);return new D(function(t,n){e.map(function(r){return D.resolve(r).then(t,n)})})},PSD:{get:function(){return C},set:function(e){return C=e}},totalEchoes:{get:function(){return bt}},newPSD:je,usePSD:Vt,scheduler:{get:function(){return le},set:function(e){le=e}},rejectionMapper:{get:function(){return _},set:function(e){_=e}},follow:function(e,t){return new D(function(n,r){return je(function(i,a){var u=C;u.unhandleds=[],u.onunhandled=a,u.finalize=fe(function(){var l,y=this;l=function(){y.unhandleds.length===0?i():a(y.unhandleds[0])},de.push(function S(){l(),de.splice(de.indexOf(S),1)}),++Z,le(function(){--Z==0&&z()},[])},u.finalize),e()},t,n,r)})}}),Ie&&(Ie.allSettled&&be(D,"allSettled",function(){var e=Ne.apply(null,arguments).map(Et);return new D(function(t){e.length===0&&t([]);var n=e.length,r=new Array(n);e.forEach(function(i,a){return D.resolve(i).then(function(u){return r[a]={status:"fulfilled",value:u}},function(u){return r[a]={status:"rejected",reason:u}}).then(function(){return--n||t(r)})})})}),Ie.any&&typeof AggregateError<"u"&&be(D,"any",function(){var e=Ne.apply(null,arguments).map(Et);return new D(function(t,n){e.length===0&&n(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach(function(a,u){return D.resolve(a).then(function(l){return t(l)},function(l){i[u]=l,--r||n(new AggregateError(i))})})})}),Ie.withResolvers)&&(D.withResolvers=Ie.withResolvers);var oe={awaits:0,echoes:0,id:0},Pe=0,St=[],Ze=0,bt=0,Bt=0;function je(e,u,n,r){var i=C,a=Object.create(i),u=(a.parent=i,a.ref=0,a.global=!1,a.id=++Bt,Y.env,a.env=tt?{Promise:D,PromiseProp:{value:D,configurable:!0,writable:!0},all:D.all,race:D.race,allSettled:D.allSettled,any:D.any,resolve:D.resolve,reject:D.reject}:{},u&&ce(a,u),++i.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()},Vt(a,e,n,r));return a.ref===0&&a.finalize(),u}function gt(){return oe.id||(oe.id=++Pe),++oe.awaits,oe.echoes+=ot,oe.id}function Fe(){return!!oe.awaits&&(--oe.awaits==0&&(oe.id=0),oe.echoes=oe.awaits*ot,!0)}function Et(e){return oe.echoes&&e&&e.constructor===Ie?(gt(),e.then(function(t){return Fe(),t},function(t){return Fe(),nt(t)})):e}function Tt(){var e=St[St.length-1];St.pop(),yt(e,!1)}function yt(e,t){var n,r,i=C;(t?!oe.echoes||Ze++&&e===C:!Ze||--Ze&&e===C)||queueMicrotask(t?(function(a){++bt,oe.echoes&&--oe.echoes!=0||(oe.echoes=oe.awaits=oe.id=0),St.push(C),yt(a,!0)}).bind(null,e):Tt),e!==C&&(C=e,i===Y&&(Y.env=Kt()),tt)&&(n=Y.env.Promise,r=e.env,i.global||e.global)&&(Object.defineProperty(k,"Promise",r.PromiseProp),n.all=r.all,n.race=r.race,n.resolve=r.resolve,n.reject=r.reject,r.allSettled&&(n.allSettled=r.allSettled),r.any)&&(n.any=r.any)}function Kt(){var e=k.Promise;return tt?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(k,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function Vt(e,t,n,r,i){var a=C;try{return yt(e,!0),t(n,r,i)}finally{yt(a,!1)}}function en(e,t,n,r){return typeof e!="function"?e:function(){var i=C;n&&gt(),yt(t,!0);try{return e.apply(this,arguments)}finally{yt(i,!1),r&&queueMicrotask(Fe)}}}function Yt(e){Promise===Ie&&oe.echoes===0?Ze===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+cn).indexOf("[native code]")===-1&&(gt=Fe=ae);var nt=D.reject,Nt="ï¿¿",rt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Ut="String expected.",Rt=[],zt="__dbnames",Yn="readonly",Gn="readwrite";function tn(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var _r={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Sn(e){return typeof e!="string"||/\./.test(e)?function(t){return t}:function(t){return t[e]===void 0&&e in t&&delete(t=Te(t))[e],t}}function Or(){throw A.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Re(e,t){try{var n=Sr(e),r=Sr(t);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":for(var i=Er(e),a=Er(t),u=i.length,l=a.length,y=u<l?u:l,S=0;S<y;++S)if(i[S]!==a[S])return i[S]<a[S]?-1:1;return u===l?0:u<l?-1:1;case"Array":for(var v=e,h=t,b=v.length,g=h.length,m=b<g?b:g,d=0;d<m;++d){var x=Re(v[d],h[d]);if(x!==0)return x}return b===g?0:b<g?-1:1}}catch{}return NaN}function Sr(e){var t=typeof e;return t=="object"&&(ArrayBuffer.isView(e)||(t=Ue(e))==="ArrayBuffer")?"binary":t}function Er(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function En(e,t,n){var r=e.schema.yProps;return r?(t&&0<n.numFailures&&(t=t.filter(function(i,a){return!n.failures[a]})),Promise.all(r.map(function(i){return i=i.updatesTable,t?e.db.table(i).where("k").anyOf(t).delete():e.db.table(i).clear()})).then(function(){return n})):n}Ar.prototype.execute=function(e){var t=this["@@propmod"];if(t.add!==void 0){var n=t.add;if(J(n))return $($([],J(e)?e:[],!0),n).sort();if(typeof n=="number")return(Number(e)||0)+n;if(typeof n=="bigint")try{return BigInt(e)+n}catch{return BigInt(0)+n}throw new TypeError("Invalid term ".concat(n))}if(t.remove!==void 0){var r=t.remove;if(J(r))return J(e)?e.filter(function(i){return!r.includes(i)}).sort():[];if(typeof r=="number")return Number(e)-r;if(typeof r=="bigint")try{return BigInt(e)-r}catch{return BigInt(0)-r}throw new TypeError("Invalid subtrahend ".concat(r))}return n=(n=t.replacePrefix)==null?void 0:n[0],n&&typeof e=="string"&&e.startsWith(n)?t.replacePrefix[1]+e.substring(n.length):e};var pn=Ar;function Ar(e){this["@@propmod"]=e}function xr(e,t){for(var n=w(t),r=n.length,i=!1,a=0;a<r;++a){var u=n[a],l=t[u],y=xe(e,u);l instanceof pn?(we(e,u,l.execute(y)),i=!0):y!==l&&(we(e,u,l),i=!0)}return i}et.prototype._trans=function(e,t,n){var r=this._tx||C.trans,i=this.name,a=dt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function u(S,v,h){if(h.schema[i])return t(h.idbtrans,h);throw new A.NotFound("Table "+i+" not part of transaction")}var l=at();try{var y=r&&r.db._novip===this.db._novip?r===C.trans?r._promise(e,u,n):je(function(){return r._promise(e,u,n)},{trans:r,transless:C.transless||C}):(function S(v,h,b,g){if(v.idbdb&&(v._state.openComplete||C.letThrough||v._vip)){var m=v._createTransaction(h,b,v._dbSchema);try{m.create(),v._state.PR1398_maxLoop=3}catch(d){return d.name===R.InvalidState&&v.isOpen()&&0<--v._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),v.close({disableAutoOpen:!1}),v.open().then(function(){return S(v,h,b,g)})):nt(d)}return m._promise(h,function(d,x){return je(function(){return C.trans=m,g(d,x,m)})}).then(function(d){if(h==="readwrite")try{m.idbtrans.commit()}catch{}return h==="readonly"?d:m._completion.then(function(){return d})})}if(v._state.openComplete)return nt(new A.DatabaseClosed(v._state.dbOpenError));if(!v._state.isBeingOpened){if(!v._state.autoOpen)return nt(new A.DatabaseClosed);v.open().catch(ae)}return v._state.dbReadyPromise.then(function(){return S(v,h,b,g)})})(this.db,e,[this.name],u);return a&&(y._consoleTask=a,y=y.catch(function(S){return console.trace(S),nt(S)})),y}finally{l&&ie()}},et.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?nt(new A.Type("Invalid argument to Table.get()")):this._trans("readonly",function(r){return n.core.get({trans:r,key:e}).then(function(i){return n.hook.reading.fire(i)})}).then(t)},et.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(J(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=w(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(l){if(l.compound&&t.every(function(S){return 0<=l.keyPath.indexOf(S)})){for(var y=0;y<t.length;++y)if(t.indexOf(l.keyPath[y])===-1)return!1;return!0}return!1}).sort(function(l,y){return l.keyPath.length-y.keyPath.length})[0];if(n&&this.db._maxKey!==Nt)return u=n.keyPath.slice(0,t.length),this.where(u).equals(u.map(function(l){return e[l]}));!n&&dt&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var r=this.schema.idxByName;function i(l,y){return Re(l,y)===0}var u=t.reduce(function(v,y){var S=v[0],v=v[1],h=r[y],b=e[y];return[S||h,S||!h?tn(v,h&&h.multi?function(g){return g=xe(g,y),J(g)&&g.some(function(m){return i(b,m)})}:function(g){return i(b,xe(g,y))}):v]},[null,null]),a=u[0],u=u[1];return a?this.where(a.name).equals(e[a.keyPath]).filter(u):n?this.filter(u):this.where(t).equals("")},et.prototype.filter=function(e){return this.toCollection().and(e)},et.prototype.count=function(e){return this.toCollection().count(e)},et.prototype.offset=function(e){return this.toCollection().offset(e)},et.prototype.limit=function(e){return this.toCollection().limit(e)},et.prototype.each=function(e){return this.toCollection().each(e)},et.prototype.toArray=function(e){return this.toCollection().toArray(e)},et.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},et.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,J(e)?"[".concat(e.join("+"),"]"):e))},et.prototype.reverse=function(){return this.toCollection().reverse()},et.prototype.mapToClass=function(e){for(var t=this.db,n=this.name,r=((this.schema.mappedClass=e).prototype instanceof Or&&(e=(u=>{var l=v,y=u;if(typeof y!="function"&&y!==null)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");function S(){this.constructor=l}function v(){return u!==null&&u.apply(this,arguments)||this}return P(l,y),l.prototype=y===null?Object.create(y):(S.prototype=y.prototype,new S),Object.defineProperty(v.prototype,"db",{get:function(){return t},enumerable:!1,configurable:!0}),v.prototype.table=function(){return n},v})(e)),new Set),i=e.prototype;i;i=E(i))Object.getOwnPropertyNames(i).forEach(function(u){return r.add(u)});function a(u){if(!u)return u;var l,y=Object.create(e.prototype);for(l in u)if(!r.has(l))try{y[l]=u[l]}catch{}return y}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=a,this.hook("reading",a),e},et.prototype.defineClass=function(){return this.mapToClass(function(e){ce(this,e)})},et.prototype.add=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,a=r.keyPath,u=e;return a&&i&&(u=Sn(a)(e)),this._trans("readwrite",function(l){return n.core.mutate({trans:l,type:"add",keys:t!=null?[t]:null,values:[u]})}).then(function(l){return l.numFailures?D.reject(l.failures[0]):l.lastResult}).then(function(l){if(a)try{we(e,a,l)}catch{}return l})},et.prototype.upsert=function(e,t){var n=this,r=this.schema.primKey.keyPath;return this._trans("readwrite",function(i){return n.core.get({trans:i,key:e}).then(function(a){var u=a??{};return xr(u,t),r&&we(u,r,e),n.core.mutate({trans:i,type:"put",values:[u],keys:[e],upsert:!0,updates:{keys:[e],changeSpecs:[t]}}).then(function(l){return l.numFailures?D.reject(l.failures[0]):!!a})})})},et.prototype.update=function(e,t){return typeof e!="object"||J(e)?this.where(":id").equals(e).modify(t):(e=xe(e,this.schema.primKey.keyPath))===void 0?nt(new A.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t)},et.prototype.put=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,a=r.keyPath,u=e;return a&&i&&(u=Sn(a)(e)),this._trans("readwrite",function(l){return n.core.mutate({trans:l,type:"put",values:[u],keys:t!=null?[t]:null})}).then(function(l){return l.numFailures?D.reject(l.failures[0]):l.lastResult}).then(function(l){if(a)try{we(e,a,l)}catch{}return l})},et.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]}).then(function(r){return En(t,[e],r)}).then(function(r){return r.numFailures?D.reject(r.failures[0]):void 0})})},et.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:_r}).then(function(n){return En(e,null,n)})}).then(function(t){return t.numFailures?D.reject(t.failures[0]):void 0})},et.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(n){return t.core.getMany({keys:e,trans:n}).then(function(r){return r.map(function(i){return t.hook.reading.fire(i)})})})},et.prototype.bulkAdd=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,a=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(u){var l=r.schema.primKey,S=l.auto,l=l.keyPath;if(l&&i)throw new A.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new A.InvalidArgument("Arguments objects and keys must have the same length");var y=e.length,S=l&&S?e.map(Sn(l)):e;return r.core.mutate({trans:u,type:"add",keys:i,values:S,wantResults:a}).then(function(v){var h=v.numFailures,b=v.failures;if(h===0)return a?v.results:v.lastResult;throw new I("".concat(r.name,".bulkAdd(): ").concat(h," of ").concat(y," operations failed"),b)})})},et.prototype.bulkPut=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,a=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(u){var l=r.schema.primKey,S=l.auto,l=l.keyPath;if(l&&i)throw new A.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new A.InvalidArgument("Arguments objects and keys must have the same length");var y=e.length,S=l&&S?e.map(Sn(l)):e;return r.core.mutate({trans:u,type:"put",keys:i,values:S,wantResults:a}).then(function(v){var h=v.numFailures,b=v.failures;if(h===0)return a?v.results:v.lastResult;throw new I("".concat(r.name,".bulkPut(): ").concat(h," of ").concat(y," operations failed"),b)})})},et.prototype.bulkUpdate=function(e){var t=this,n=this.core,r=e.map(function(u){return u.key}),i=e.map(function(u){return u.changes}),a=[];return this._trans("readwrite",function(u){return n.getMany({trans:u,keys:r,cache:"clone"}).then(function(l){var y=[],S=[],v=(e.forEach(function(h,b){var g=h.key,m=h.changes,d=l[b];if(d){for(var x=0,T=Object.keys(m);x<T.length;x++){var O=T[x],K=m[O];if(O===t.schema.primKey.keyPath){if(Re(K,g)!==0)throw new A.Constraint("Cannot update primary key in bulkUpdate()")}else we(d,O,K)}a.push(b),y.push(g),S.push(d)}}),y.length);return n.mutate({trans:u,type:"put",keys:y,values:S,updates:{keys:r,changeSpecs:i}}).then(function(h){var b=h.numFailures,g=h.failures;if(b===0)return v;for(var m=0,d=Object.keys(g);m<d.length;m++){var x,T=d[m],O=a[Number(T)];O!=null&&(x=g[T],delete g[T],g[O]=x)}throw new I("".concat(t.name,".bulkUpdate(): ").concat(b," of ").concat(v," operations failed"),g)})})})},et.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",function(r){return t.core.mutate({trans:r,type:"delete",keys:e}).then(function(i){return En(t,e,i)})}).then(function(r){var i=r.numFailures,a=r.failures;if(i===0)return r.lastResult;throw new I("".concat(t.name,".bulkDelete(): ").concat(i," of ").concat(n," operations failed"),a)})};var Tr=et;function et(){}function hn(e){function t(u,l){if(l){for(var y=arguments.length,S=new Array(y-1);--y;)S[y-1]=arguments[y];return n[u].subscribe.apply(null,S),e}if(typeof u=="string")return n[u]}var n={};t.addEventType=a;for(var r=1,i=arguments.length;r<i;++r)a(arguments[r]);return t;function a(u,l,y){var S,v;if(typeof u!="object")return l=l||Ft,v={subscribers:[],fire:y=y||ae,subscribe:function(h){v.subscribers.indexOf(h)===-1&&(v.subscribers.push(h),v.fire=l(v.fire,h))},unsubscribe:function(h){v.subscribers=v.subscribers.filter(function(b){return b!==h}),v.fire=v.subscribers.reduce(l,y)}},n[u]=t[u]=v;w(S=u).forEach(function(h){var b=S[h];if(J(b))a(h,S[h][0],S[h][1]);else{if(b!=="asap")throw new A.InvalidArgument("Invalid event config");var g=a(h,Ee,function(){for(var m=arguments.length,d=new Array(m);m--;)d[m]=arguments[m];g.subscribers.forEach(function(x){me(function(){x.apply(null,d)})})})}})}}function dn(e,t){return ge(t).from({prototype:e}),t}function an(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Jn(e,t){e.filter=tn(e.filter,t)}function zn(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return tn(r(),t())}:t,e.justLimit=n&&!r}function An(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(n)return n;throw new A.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed")}function kr(e,t,n){var r=An(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:r,range:e.range}})}function xn(e,t,n,r){var i,a,u=e.replayFilter?tn(e.filter,e.replayFilter()):e.filter;return e.or?(i={},a=function(l,y,S){var v,h;u&&!u(y,S,function(b){return y.stop(b)},function(b){return y.fail(b)})||((h=""+(v=y.primaryKey))=="[object ArrayBuffer]"&&(h=""+new Uint8Array(v)),te(i,h))||(i[h]=!0,t(l,y,S))},Promise.all([e.or._iterate(a,n),Pr(kr(e,r,n),e.algorithm,a,!e.keysOnly&&e.valueMapper)])):Pr(kr(e,r,n),tn(e.algorithm,u),t,!e.keysOnly&&e.valueMapper)}function Pr(e,t,n,r){var i=X(r?function(a,u,l){return n(r(a),u,l)}:n);return e.then(function(a){if(a)return a.start(function(){var u=function(){return a.continue()};t&&!t(a,function(l){return u=l},function(l){a.stop(l),u=ae},function(l){a.fail(l),u=ae})||i(a.value,a,function(l){return u=l}),u()})})}$e.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,nt.bind(null,n.error)):n.table._trans("readonly",e).then(t)},$e.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,nt.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},$e.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=tn(t.algorithm,e)},$e.prototype._iterate=function(e,t){return xn(this._ctx,e,t,this._ctx.table.core)},$e.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&ce(n,e),t._ctx=n,t},$e.prototype.raw=function(){return this._ctx.valueMapper=null,this},$e.prototype.each=function(e){var t=this._ctx;return this._read(function(n){return xn(t,e,n,t.table.core)})},$e.prototype.count=function(e){var t=this;return this._read(function(n){var r,i=t._ctx,a=i.table.core;return an(i,!0)?a.count({trans:n,query:{index:An(i,a.schema),range:i.range}}).then(function(u){return Math.min(u,i.limit)}):(r=0,xn(i,function(){return++r,!1},n,a).then(function(){return r}))}).then(e)},$e.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],i=n.length-1;function a(y,S){return S?a(y[n[S]],S-1):y[r]}var u=this._ctx.dir==="next"?1:-1;function l(y,S){return Re(a(y,i),a(S,i))*u}return this.toArray(function(y){return y.sort(l)}).then(t)},$e.prototype.toArray=function(e){var t=this;return this._read(function(n){var r,i,a,u=t._ctx;return u.dir==="next"&&an(u,!0)&&0<u.limit?(r=u.valueMapper,i=An(u,u.table.core.schema),u.table.core.query({trans:n,limit:u.limit,values:!0,query:{index:i,range:u.range}}).then(function(l){return l=l.result,r?l.map(r):l})):(a=[],xn(u,function(l){return a.push(l)},n,u.table.core).then(function(){return a}))},e)},$e.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,an(t)?zn(t,function(){var n=e;return function(r,i){return n===0||(n===1?--n:i(function(){r.advance(n),n=0}),!1)}}):zn(t,function(){var n=e;return function(){return--n<0}})),this},$e.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),zn(this._ctx,function(){var t=e;return function(n,r,i){return--t<=0&&r(i),0<=t}},!0),this},$e.prototype.until=function(e,t){return Jn(this._ctx,function(n,r,i){return!e(n.value)||(r(i),t)}),this},$e.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},$e.prototype.last=function(e){return this.reverse().first(e)},$e.prototype.filter=function(e){var t;return Jn(this._ctx,function(n){return e(n.value)}),(t=this._ctx).isMatch=tn(t.isMatch,e),this},$e.prototype.and=function(e){return this.filter(e)},$e.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},$e.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},$e.prototype.desc=function(){return this.reverse()},$e.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,r){e(r.key,r)})},$e.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},$e.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,r){e(r.primaryKey,r)})},$e.prototype.keys=function(e){var t=this._ctx,n=(t.keysOnly=!t.isMatch,[]);return this.each(function(r,i){n.push(i.key)}).then(function(){return n}).then(e)},$e.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&an(t,!0)&&0<t.limit)return this._read(function(r){var i=An(t,t.table.core.schema);return t.table.core.query({trans:r,values:!1,limit:t.limit,query:{index:i,range:t.range}})}).then(function(r){return r.result}).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each(function(r,i){n.push(i.primaryKey)}).then(function(){return n}).then(e)},$e.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},$e.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},$e.prototype.lastKey=function(e){return this.reverse().firstKey(e)},$e.prototype.distinct=function(){var e,t=this._ctx,t=t.index&&t.table.schema.idxByName[t.index];return t&&t.multi&&(e={},Jn(this._ctx,function(r){var r=r.primaryKey.toString(),i=te(e,r);return e[r]=!0,!i})),this},$e.prototype.modify=function(e){var t=this,n=this._ctx;return this._write(function(r){function i(d,x){var T=x.failures;b+=d-x.numFailures;for(var O=0,K=w(T);O<K.length;O++){var U=K[O];h.push(T[U])}}var a=typeof e=="function"?e:function(d){return xr(d,e)},u=n.table.core,v=u.schema.primaryKey,l=v.outbound,y=v.extractKey,S=200,v=t.db._options.modifyChunkSize,h=(v&&(S=typeof v=="object"?v[u.name]||v["*"]||200:v),[]),b=0,g=[],m=e===Nr;return t.clone().primaryKeys().then(function(d){function x(O){var K=Math.min(S,d.length-O),U=d.slice(O,O+K);return(m?Promise.resolve([]):u.getMany({trans:r,keys:U,cache:"immutable"})).then(function(W){var H=[],M=[],re=l?[]:null,ne=m?U:[];if(!m)for(var G=0;G<K;++G){var ue=W[G],Le={value:Te(ue),primKey:d[O+G]};a.call(Le,Le.value,Le)!==!1&&(Le.value==null?ne.push(d[O+G]):l||Re(y(ue),y(Le.value))===0?(M.push(Le.value),l&&re.push(d[O+G])):(ne.push(d[O+G]),H.push(Le.value)))}return Promise.resolve(0<H.length&&u.mutate({trans:r,type:"add",values:H}).then(function(Ye){for(var ye in Ye.failures)ne.splice(parseInt(ye),1);i(H.length,Ye)})).then(function(){return(0<M.length||T&&typeof e=="object")&&u.mutate({trans:r,type:"put",keys:re,values:M,criteria:T,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<O}).then(function(Ye){return i(M.length,Ye)})}).then(function(){return(0<ne.length||T&&m)&&u.mutate({trans:r,type:"delete",keys:ne,criteria:T,isAdditionalChunk:0<O}).then(function(Ye){return En(n.table,ne,Ye)}).then(function(Ye){return i(ne.length,Ye)})}).then(function(){return d.length>O+K&&x(O+S)})})}var T=an(n)&&n.limit===1/0&&(typeof e!="function"||m)&&{index:n.index,range:n.range};return x(0).then(function(){if(0<h.length)throw new vt("Error modifying one or more objects",h,b,g);return d.length})})})},$e.prototype.delete=function(){var e=this._ctx,t=e.range;return!an(e)||e.table.schema.yProps||!e.isPrimKey&&t.type!==3?this.modify(Nr):this._write(function(n){var r=e.table.core.schema.primaryKey,i=t;return e.table.core.count({trans:n,query:{index:r,range:i}}).then(function(a){return e.table.core.mutate({trans:n,type:"deleteRange",range:i}).then(function(y){var l=y.failures,y=y.numFailures;if(y)throw new vt("Could not delete some values",Object.keys(l).map(function(S){return l[S]}),a-y);return a-y})})})};var oi=$e;function $e(){}var Nr=function(e,t){return t.value=null};function ai(e,t){return e<t?-1:e===t?0:1}function ui(e,t){return t<e?-1:e===t?0:1}function Lt(e,t,n){return e=e instanceof Cr?new e.Collection(e):e,e._ctx.error=new(n||TypeError)(t),e}function un(e){return new e.Collection(e,function(){return jr("")}).limit(0)}function Tn(g,t,n,r){var i,a,u,l,y,S,v,h=n.length;if(!n.every(function(d){return typeof d=="string"}))return Lt(g,Ut);function b(d){i=d==="next"?function(T){return T.toUpperCase()}:function(T){return T.toLowerCase()},a=d==="next"?function(T){return T.toLowerCase()}:function(T){return T.toUpperCase()},u=d==="next"?ai:ui;var x=n.map(function(T){return{lower:a(T),upper:i(T)}}).sort(function(T,O){return u(T.lower,O.lower)});l=x.map(function(T){return T.upper}),y=x.map(function(T){return T.lower}),v=(S=d)==="next"?"":r}b("next");var g=new g.Collection(g,function(){return Ht(l[0],y[h-1]+r)}),m=(g._ondirectionchange=function(d){b(d)},0);return g._addAlgorithm(function(d,x,T){var O=d.key;if(typeof O=="string"){var K=a(O);if(t(K,y,m))return!0;for(var U=null,W=m;W<h;++W){var H=((M,re,ne,G,ue,Le)=>{for(var Ye=Math.min(M.length,G.length),ye=-1,ke=0;ke<Ye;++ke){var st=re[ke];if(st!==G[ke])return ue(M[ke],ne[ke])<0?M.substr(0,ke)+ne[ke]+ne.substr(ke+1):ue(M[ke],G[ke])<0?M.substr(0,ke)+G[ke]+ne.substr(ke+1):0<=ye?M.substr(0,ye)+re[ye]+ne.substr(ye+1):null;ue(M[ke],st)<0&&(ye=ke)}return Ye<G.length&&Le==="next"?M+ne.substr(M.length):Ye<M.length&&Le==="prev"?M.substr(0,ne.length):ye<0?null:M.substr(0,ye)+G[ye]+ne.substr(ye+1)})(O,K,l[W],y[W],u,S);H===null&&U===null?m=W+1:(U===null||0<u(U,H))&&(U=H)}x(U!==null?function(){d.continue(U+v)}:T)}return!1}),g}function Ht(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function jr(e){return{type:1,lower:e,upper:e}}Object.defineProperty(At.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),At.prototype.between=function(e,t,n,r){n=n!==!1,r=r===!0;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(n||r)&&(!n||!r)?un(this):new this.Collection(this,function(){return Ht(e,t,!n,!r)})}catch{return Lt(this,rt)}},At.prototype.equals=function(e){return e==null?Lt(this,rt):new this.Collection(this,function(){return jr(e)})},At.prototype.above=function(e){return e==null?Lt(this,rt):new this.Collection(this,function(){return Ht(e,void 0,!0)})},At.prototype.aboveOrEqual=function(e){return e==null?Lt(this,rt):new this.Collection(this,function(){return Ht(e,void 0,!1)})},At.prototype.below=function(e){return e==null?Lt(this,rt):new this.Collection(this,function(){return Ht(void 0,e,!1,!0)})},At.prototype.belowOrEqual=function(e){return e==null?Lt(this,rt):new this.Collection(this,function(){return Ht(void 0,e)})},At.prototype.startsWith=function(e){return typeof e!="string"?Lt(this,Ut):this.between(e,e+Nt,!0,!0)},At.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):Tn(this,function(t,n){return t.indexOf(n[0])===0},[e],Nt)},At.prototype.equalsIgnoreCase=function(e){return Tn(this,function(t,n){return t===n[0]},[e],"")},At.prototype.anyOfIgnoreCase=function(){var e=Ne.apply(ut,arguments);return e.length===0?un(this):Tn(this,function(t,n){return n.indexOf(t)!==-1},e,"")},At.prototype.startsWithAnyOfIgnoreCase=function(){var e=Ne.apply(ut,arguments);return e.length===0?un(this):Tn(this,function(t,n){return n.some(function(r){return t.indexOf(r)===0})},e,Nt)},At.prototype.anyOf=function(){var e,t,n=this,r=Ne.apply(ut,arguments),i=this._cmp;try{r.sort(i)}catch{return Lt(this,rt)}return r.length===0?un(this):((e=new this.Collection(this,function(){return Ht(r[0],r[r.length-1])}))._ondirectionchange=function(a){i=a==="next"?n._ascending:n._descending,r.sort(i)},t=0,e._addAlgorithm(function(a,u,l){for(var y=a.key;0<i(y,r[t]);)if(++t===r.length)return u(l),!1;return i(y,r[t])===0||(u(function(){a.continue(r[t])}),!1)}),e)},At.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},At.prototype.noneOf=function(){var e=Ne.apply(ut,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Lt(this,rt)}var t=e.reduce(function(n,r){return n?n.concat([[n[n.length-1][1],r]]):[[-1/0,r]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},At.prototype.inAnyRange=function(e,T){var n=this,r=this._cmp,i=this._ascending,a=this._descending,u=this._min,l=this._max;if(e.length===0)return un(this);if(!e.every(function(O){return O[0]!==void 0&&O[1]!==void 0&&i(O[0],O[1])<=0}))return Lt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",A.InvalidArgument);var y=!T||T.includeLowers!==!1,S=T&&T.includeUppers===!0,v,h=i;function b(O,K){return h(O[0],K[0])}try{(v=e.reduce(function(O,K){for(var U=0,W=O.length;U<W;++U){var H=O[U];if(r(K[0],H[1])<0&&0<r(K[1],H[0])){H[0]=u(H[0],K[0]),H[1]=l(H[1],K[1]);break}}return U===W&&O.push(K),O},[])).sort(b)}catch{return Lt(this,rt)}var g=0,m=S?function(O){return 0<i(O,v[g][1])}:function(O){return 0<=i(O,v[g][1])},d=y?function(O){return 0<a(O,v[g][0])}:function(O){return 0<=a(O,v[g][0])},x=m,T=new this.Collection(this,function(){return Ht(v[0][0],v[v.length-1][1],!y,!S)});return T._ondirectionchange=function(O){h=O==="next"?(x=m,i):(x=d,a),v.sort(b)},T._addAlgorithm(function(O,K,U){for(var W,H=O.key;x(H);)if(++g===v.length)return K(U),!1;return!m(W=H)&&!d(W)||(n._cmp(H,v[g][1])===0||n._cmp(H,v[g][0])===0||K(function(){h===i?O.continue(v[g][0]):O.continue(v[g][1])}),!1)}),T},At.prototype.startsWithAnyOf=function(){var e=Ne.apply(ut,arguments);return e.every(function(t){return typeof t=="string"})?e.length===0?un(this):this.inAnyRange(e.map(function(t){return[t,t+Nt]})):Lt(this,"startsWithAnyOf() only works with strings")};var Cr=At;function At(){}function Gt(e){return X(function(t){return yn(t),e(t.target.error),!1})}function yn(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var vn="storagemutated",Wn="x-storagemutated-1",Qt=hn(null,vn),si=(Jt.prototype._lock=function(){return pt(!C.global),++this._reculock,this._reculock!==1||C.global||(C.lockOwnerFor=this),this},Jt.prototype._unlock=function(){if(pt(!C.global),--this._reculock==0)for(C.global||(C.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{Vt(e[1],e[0])}catch{}}return this},Jt.prototype._locked=function(){return this._reculock&&C.lockOwnerFor!==this},Jt.prototype.create=function(e){var t=this;if(this.mode){var n=this.db.idbdb,r=this.db._state.dbOpenError;if(pt(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new A.DatabaseClosed(r);case"MissingAPIError":throw new A.MissingAPI(r.message,r);default:throw new A.OpenFailed(r)}if(!this.active)throw new A.TransactionInactive;pt(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||n).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=X(function(i){yn(i),t._reject(e.error)}),e.onabort=X(function(i){yn(i),t.active&&t._reject(new A.Abort(e.error)),t.active=!1,t.on("abort").fire(i)}),e.oncomplete=X(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&Qt.storagemutated.fire(e.mutatedParts)})}return this},Jt.prototype._promise=function(e,t,n){var r,i=this;return e==="readwrite"&&this.mode!=="readwrite"?nt(new A.ReadOnly("Transaction is readonly")):this.active?this._locked()?new D(function(a,u){i._blockedFuncs.push([function(){i._promise(e,t,n).then(a,u)},C])}):n?je(function(){var a=new D(function(u,l){i._lock();var y=t(u,l,i);y&&y.then&&y.then(u,l)});return a.finally(function(){return i._unlock()}),a._lib=!0,a}):((r=new D(function(a,u){var l=t(a,u,i);l&&l.then&&l.then(a,u)}))._lib=!0,r):nt(new A.TransactionInactive)},Jt.prototype._root=function(){return this.parent?this.parent._root():this},Jt.prototype.waitFor=function(e){var t,n=this._root(),r=D.resolve(e),i=(n._waitingFor?n._waitingFor=n._waitingFor.then(function(){return r}):(n._waitingFor=r,n._waitingQueue=[],t=n.idbtrans.objectStore(n.storeNames[0]),(function a(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(t.get(-1/0).onsuccess=a)})()),n._waitingFor);return new D(function(a,u){r.then(function(l){return n._waitingQueue.push(X(a.bind(null,l)))},function(l){return n._waitingQueue.push(X(u.bind(null,l)))}).finally(function(){n._waitingFor===i&&(n._waitingFor=null)})})},Jt.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new A.Abort))},Jt.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(te(t,e))return t[e];var n=this.schema[e];if(n)return(n=new this.db.Table(e,n,this)).core=this.db.core.table(e),t[e]=n;throw new A.NotFound("Table "+e+" not part of transaction")},Jt);function Jt(){}function Hn(e,t,n,r,i,a,u,l){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:a,src:(n&&!u?"&":"")+(r?"*":"")+(i?"++":"")+Ir(t),type:l}}function Ir(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function Qn(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:(r=function(i){return[i.name,i]},n.reduce(function(i,a,u){return a=r(a,u),a&&(i[a[0]]=a[1]),i},{}))};var r}var mn=function(e){try{return e.only([[]]),mn=function(){return[[]]},[[]]}catch{return mn=function(){return Nt},Nt}};function Xn(e){return e==null?function(){}:typeof e=="string"?(t=e).split(".").length===1?function(n){return n[t]}:function(n){return xe(n,t)}:function(n){return xe(n,e)};var t}function Br(e){return[].slice.call(e)}var ci=0;function bn(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function li(e,t,y){function r(m){if(m.type===3)return null;if(m.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var h=m.lower,b=m.upper,g=m.lowerOpen,m=m.upperOpen;return h===void 0?b===void 0?null:t.upperBound(b,!!m):b===void 0?t.lowerBound(h,!!g):t.bound(h,b,!!g,!!m)}function i(v){var h,b=v.name;return{name:b,schema:v,mutate:function(g){var m=g.trans,d=g.type,x=g.keys,T=g.values,O=g.range;return new Promise(function(K,U){K=X(K);var W=m.objectStore(b),H=W.keyPath==null,M=d==="put"||d==="add";if(!M&&d!=="delete"&&d!=="deleteRange")throw new Error("Invalid operation type: "+d);var re,ne=(x||T||{length:1}).length;if(x&&T&&x.length!==T.length)throw new Error("Given keys array must have same length as given values array.");if(ne===0)return K({numFailures:0,failures:{},results:[],lastResult:void 0});function G(ft){++Ye,yn(ft)}var ue=[],Le=[],Ye=0;if(d==="deleteRange"){if(O.type===4)return K({numFailures:Ye,failures:Le,results:[],lastResult:void 0});O.type===3?ue.push(re=W.clear()):ue.push(re=W.delete(r(O)))}else{var H=M?H?[T,x]:[T,null]:[x,null],ye=H[0],ke=H[1];if(M)for(var st=0;st<ne;++st)ue.push(re=ke&&ke[st]!==void 0?W[d](ye[st],ke[st]):W[d](ye[st])),re.onerror=G;else for(st=0;st<ne;++st)ue.push(re=W[d](ye[st])),re.onerror=G}function qt(ft){ft=ft.target.result,ue.forEach(function(on,vr){return on.error!=null&&(Le[vr]=on.error)}),K({numFailures:Ye,failures:Le,results:d==="delete"?x:ue.map(function(on){return on.result}),lastResult:ft})}re.onerror=function(ft){G(ft),qt(ft)},re.onsuccess=qt})},getMany:function(g){var m=g.trans,d=g.keys;return new Promise(function(x,T){x=X(x);for(var O,K=m.objectStore(b),U=d.length,W=new Array(U),H=0,M=0,re=function(ue){ue=ue.target,W[ue._pos]=ue.result,++M===H&&x(W)},ne=Gt(T),G=0;G<U;++G)d[G]!=null&&((O=K.get(d[G]))._pos=G,O.onsuccess=re,O.onerror=ne,++H);H===0&&x(W)})},get:function(g){var m=g.trans,d=g.key;return new Promise(function(x,T){x=X(x);var O=m.objectStore(b).get(d);O.onsuccess=function(K){return x(K.target.result)},O.onerror=Gt(T)})},query:(h=l,function(g){return new Promise(function(m,d){m=X(m);var x,T,O,M=g.trans,K=g.values,U=g.limit,H=g.query,W=U===1/0?void 0:U,re=H.index,H=H.range,M=M.objectStore(b),M=re.isPrimaryKey?M:M.index(re.name),re=r(H);if(U===0)return m({result:[]});h?((H=K?M.getAll(re,W):M.getAllKeys(re,W)).onsuccess=function(ne){return m({result:ne.target.result})},H.onerror=Gt(d)):(x=0,T=!K&&"openKeyCursor"in M?M.openKeyCursor(re):M.openCursor(re),O=[],T.onsuccess=function(ne){var G=T.result;return!G||(O.push(K?G.value:G.primaryKey),++x===U)?m({result:O}):void G.continue()},T.onerror=Gt(d))})}),openCursor:function(g){var m=g.trans,d=g.values,x=g.query,T=g.reverse,O=g.unique;return new Promise(function(K,U){K=X(K);var M=x.index,W=x.range,H=m.objectStore(b),H=M.isPrimaryKey?H:H.index(M.name),M=T?O?"prevunique":"prev":O?"nextunique":"next",re=!d&&"openKeyCursor"in H?H.openKeyCursor(r(W),M):H.openCursor(r(W),M);re.onerror=Gt(U),re.onsuccess=X(function(ne){var G,ue,Le,Ye,ye=re.result;ye?(ye.___id=++ci,ye.done=!1,G=ye.continue.bind(ye),ue=(ue=ye.continuePrimaryKey)&&ue.bind(ye),Le=ye.advance.bind(ye),Ye=function(){throw new Error("Cursor not stopped")},ye.trans=m,ye.stop=ye.continue=ye.continuePrimaryKey=ye.advance=function(){throw new Error("Cursor not started")},ye.fail=X(U),ye.next=function(){var ke=this,st=1;return this.start(function(){return st--?ke.continue():ke.stop()}).then(function(){return ke})},ye.start=function(ke){function st(){if(re.result)try{ke()}catch(ft){ye.fail(ft)}else ye.done=!0,ye.start=function(){throw new Error("Cursor behind last entry")},ye.stop()}var qt=new Promise(function(ft,on){ft=X(ft),re.onerror=Gt(on),ye.fail=on,ye.stop=function(vr){ye.stop=ye.continue=ye.continuePrimaryKey=ye.advance=Ye,ft(vr)}});return re.onsuccess=X(function(ft){re.onsuccess=st,st()}),ye.continue=G,ye.continuePrimaryKey=ue,ye.advance=Le,st(),qt},K(ye)):K(null)},U)})},count:function(g){var m=g.query,d=g.trans,x=m.index,T=m.range;return new Promise(function(O,K){var U=d.objectStore(b),U=x.isPrimaryKey?U:U.index(x.name),W=r(T),W=W?U.count(W):U.count();W.onsuccess=X(function(H){return O(H.target.result)}),W.onerror=Gt(K)})}}}a=y,u=Br((y=e).objectStoreNames);var a,y={schema:{name:y.name,tables:u.map(function(v){return a.objectStore(v)}).map(function(v){var h=v.keyPath,b=v.autoIncrement,m=J(h),g={},m={name:v.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:h==null,compound:m,keyPath:h,autoIncrement:b,unique:!0,extractKey:Xn(h)},indexes:Br(v.indexNames).map(function(d){return v.index(d)}).map(function(O){var K=O.name,x=O.unique,T=O.multiEntry,O=O.keyPath,K={name:K,compound:J(O),keyPath:O,unique:x,multiEntry:T,extractKey:Xn(O)};return g[bn(O)]=K}),getIndexByKeyPath:function(d){return g[bn(d)]}};return g[":id"]=m.primaryKey,h!=null&&(g[bn(h)]=m.primaryKey),m})},hasGetAll:0<u.length&&"getAll"in a.objectStore(u[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},u=y.schema,l=y.hasGetAll,y=u.tables.map(i),S={};return y.forEach(function(v){return S[v.name]=v}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(v){if(S[v])return S[v];throw new Error("Table '".concat(v,"' not found"))},MIN_KEY:-1/0,MAX_KEY:mn(t),schema:u}}function fi(e,t,n,r){return n=n.IDBKeyRange,t=li(t,n,r),{dbcore:e.dbcore.reduce(function(i,a){return a=a.create,N(N({},i),a(i))},t)}}function kn(e,t){var n=t.db,n=fi(e._middlewares,n,e._deps,t);e.core=n.dbcore,e.tables.forEach(function(r){var i=r.name;e.core.schema.tables.some(function(a){return a.name===i})&&(r.core=e.core.table(i),e[i]instanceof e.Table)&&(e[i].core=r.core)})}function Pn(e,t,n,r){n.forEach(function(i){var a=r[i];t.forEach(function(u){var l=(function y(S,v){return Me(S,v)||(S=E(S))&&y(S,v)})(u,i);(!l||"value"in l&&l.value===void 0)&&(u===e.Transaction.prototype||u instanceof e.Transaction?be(u,i,{get:function(){return this.table(i)},set:function(y){Qe(this,i,{value:y,writable:!0,configurable:!0,enumerable:!0})}}):u[i]=new e.Table(i,a))})})}function Zn(e,t){t.forEach(function(n){for(var r in n)n[r]instanceof e.Table&&delete n[r]})}function pi(e,t){return e._cfg.version-t._cfg.version}function hi(e,t,n,r){var i=e._dbSchema,a=(n.objectStoreNames.contains("$meta")&&!i.$meta&&(i.$meta=Qn("$meta",Rr("")[0],[]),e._storeNames.push("$meta")),e._createTransaction("readwrite",e._storeNames,i)),u=(a.create(n),a._completion.catch(r),a._reject.bind(a)),l=C.transless||C;je(function(){if(C.trans=a,C.transless=l,t!==0)return kn(e,n),S=t,((y=a).storeNames.includes("$meta")?y.table("$meta").get("version").then(function(v){return v??S}):D.resolve(S)).then(function(x){var h=e,b=x,g=a,m=n,d=[],x=h._versions,T=h._dbSchema=jn(0,h.idbdb,m);return(x=x.filter(function(O){return O._cfg.version>=b})).length===0?D.resolve():(x.forEach(function(O){d.push(function(){var K,U,W,H=T,M=O._cfg.dbschema,re=(Cn(h,H,m),Cn(h,M,m),T=h._dbSchema=M,er(H,M)),ne=(re.add.forEach(function(G){tr(m,G[0],G[1].primKey,G[1].indexes)}),re.change.forEach(function(G){if(G.recreate)throw new A.Upgrade("Not yet support for changing primary key");var ue=m.objectStore(G.name);G.add.forEach(function(Le){return Nn(ue,Le)}),G.change.forEach(function(Le){ue.deleteIndex(Le.name),Nn(ue,Le)}),G.del.forEach(function(Le){return ue.deleteIndex(Le)})}),O._cfg.contentUpgrade);if(ne&&O._cfg.version>b)return kn(h,m),g._memoizedTables={},K=Ot(M),re.del.forEach(function(G){K[G]=H[G]}),Zn(h,[h.Transaction.prototype]),Pn(h,[h.Transaction.prototype],w(K),K),g.schema=K,(U=He(ne))&&gt(),M=D.follow(function(){var G;(W=ne(g))&&U&&(G=Fe.bind(null,null),W.then(G,G))}),W&&typeof W.then=="function"?D.resolve(W):M.then(function(){return W})}),d.push(function(K){var U,W,H=O._cfg.dbschema;U=H,W=K,[].slice.call(W.db.objectStoreNames).forEach(function(M){return U[M]==null&&W.db.deleteObjectStore(M)}),Zn(h,[h.Transaction.prototype]),Pn(h,[h.Transaction.prototype],h._storeNames,h._dbSchema),g.schema=h._dbSchema}),d.push(function(K){h.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(h.idbdb.version/10)===O._cfg.version?(h.idbdb.deleteObjectStore("$meta"),delete h._dbSchema.$meta,h._storeNames=h._storeNames.filter(function(U){return U!=="$meta"})):K.objectStore("$meta").put(O._cfg.version,"version"))})}),(function O(){return d.length?D.resolve(d.shift()(g.idbtrans)).then(O):D.resolve()})().then(function(){Kr(T,m)}))}).catch(u);var y,S;w(i).forEach(function(v){tr(n,v,i[v].primKey,i[v].indexes)}),kn(e,n),D.follow(function(){return e.on.populate.fire(a)}).catch(u)})}function di(e,t){Kr(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=jn(0,e.idbdb,t);Cn(e,e._dbSchema,t);for(var r=0,i=er(n,e._dbSchema).change;r<i.length;r++){var a=(u=>{if(u.change.length||u.recreate)return console.warn("Unable to patch indexes of table ".concat(u.name," because it has changes on the type of index or primary key.")),{value:void 0};var l=t.objectStore(u.name);u.add.forEach(function(y){dt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(u.name,".").concat(y.src)),Nn(l,y)})})(i[r]);if(typeof a=="object")return a.value}}function er(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var i=e[n],a=t[n];if(i){var u={name:n,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||i.primKey.auto!==a.primKey.auto)u.recreate=!0,r.change.push(u);else{var l=i.idxByName,y=a.idxByName,S=void 0;for(S in l)y[S]||u.del.push(S);for(S in y){var v=l[S],h=y[S];v?v.src!==h.src&&u.change.push(h):u.add.push(h)}(0<u.del.length||0<u.add.length||0<u.change.length)&&r.change.push(u)}}else r.add.push([n,a])}return r}function tr(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});r.forEach(function(a){return Nn(i,a)})}function Kr(e,t){w(e).forEach(function(n){t.db.objectStoreNames.contains(n)||(dt&&console.debug("Dexie: Creating missing table",n),tr(t,n,e[n].primKey,e[n].indexes))})}function Nn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function jn(e,t,n){var r={};return Xe(t.objectStoreNames,0).forEach(function(i){for(var a=n.objectStore(i),u=Hn(Ir(S=a.keyPath),S||"",!0,!1,!!a.autoIncrement,S&&typeof S!="string",!0),l=[],y=0;y<a.indexNames.length;++y){var v=a.index(a.indexNames[y]),S=v.keyPath,v=Hn(v.name,S,!!v.unique,!!v.multiEntry,!1,S&&typeof S!="string",!1);l.push(v)}r[i]=Qn(i,u,l)}),r}function Cn(e,t,n){for(var r=n.db.objectStoreNames,i=0;i<r.length;++i){var a=r[i],u=n.objectStore(a);e._hasGetAll="getAll"in u;for(var l=0;l<u.indexNames.length;++l){var y,S=u.indexNames[l],v=u.index(S).keyPath,v=typeof v=="string"?v:"["+Xe(v).join("+")+"]";t[a]&&(y=t[a].idxByName[v])&&(y.name=S,delete t[a].idxByName[v],t[a].idxByName[S]=y)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&k.WorkerGlobalScope&&k instanceof k.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function Rr(e){return e.split(",").map(function(t,n){var i=t.split(":"),r=(r=i[1])==null?void 0:r.trim(),i=(t=i[0].trim()).replace(/([&*]|\+\+)/g,""),a=/^\[/.test(i)?i.match(/^\[(.*)\]$/)[1].split("+"):i;return Hn(i,a||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),J(a),n===0,r)})}sn.prototype._createTableSchema=Qn,sn.prototype._parseIndexSyntax=Rr,sn.prototype._parseStoresSpec=function(e,t){var n=this;w(e).forEach(function(r){if(e[r]!==null){var i=n._parseIndexSyntax(e[r]),a=i.shift();if(!a)throw new A.Schema("Invalid schema for table "+r+": "+e[r]);if(a.unique=!0,a.multi)throw new A.Schema("Primary key cannot be multiEntry*");i.forEach(function(u){if(u.auto)throw new A.Schema("Only primary key can be marked as autoIncrement (++)");if(!u.keyPath)throw new A.Schema("Index must have a name and cannot be an empty string")}),a=n._createTableSchema(r,a,i),t[r]=a}})},sn.prototype.stores=function(n){var t=this.db,n=(this._cfg.storesSource=this._cfg.storesSource?ce(this._cfg.storesSource,n):n,t._versions),r={},i={};return n.forEach(function(a){ce(r,a._cfg.storesSource),i=a._cfg.dbschema={},a._parseStoresSpec(r,i)}),t._dbSchema=i,Zn(t,[t._allTables,t,t.Transaction.prototype]),Pn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],w(i),i),t._storeNames=w(i),this},sn.prototype.upgrade=function(e){return this._cfg.contentUpgrade=It(this._cfg.contentUpgrade||ae,e),this};var yi=sn;function sn(){}function nr(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new Wt(zt,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function rr(e){return e&&typeof e.databases=="function"}function ir(e){return je(function(){return C.letThrough=!0,e()})}function or(e){return!("from"in e)}var jt=function(e,t){var n;if(!this)return n=new jt,e&&"d"in e&&ce(n,e),n;ce(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function gn(e,t,n){var r=Re(t,n);if(!isNaN(r)){if(0<r)throw RangeError();if(or(e))return ce(e,{from:t,to:n,d:1});var r=e.l,i=e.r;if(Re(n,e.from)<0)return r?gn(r,t,n):e.l={from:t,to:n,d:1,l:null,r:null},Fr(e);if(0<Re(t,e.to))return i?gn(i,t,n):e.r={from:t,to:n,d:1,l:null,r:null},Fr(e);Re(t,e.from)<0&&(e.from=t,e.l=null,e.d=i?i.d+1:1),0<Re(n,e.to)&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1),t=!e.r,r&&!e.l&&wn(e,r),i&&t&&wn(e,i)}}function wn(e,t){or(t)||(function n(r,i){var a=i.from,u=i.l,l=i.r;gn(r,a,i.to),u&&n(r,u),l&&n(r,l)})(e,t)}function Dr(e,t){var n=In(t),r=n.next();if(!r.done)for(var i=r.value,a=In(e),u=a.next(i.from),l=u.value;!r.done&&!u.done;){if(Re(l.from,i.to)<=0&&0<=Re(l.to,i.from))return!0;Re(i.from,l.from)<0?i=(r=n.next(l.from)).value:l=(u=a.next(i.from)).value}return!1}function In(e){var t=or(e)?null:{s:0,n:e};return{next:function(n){for(var r=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,r)for(;t.n.l&&Re(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!r||Re(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function Fr(e){var t,n,r,i=(((i=e.r)==null?void 0:i.d)||0)-(((i=e.l)==null?void 0:i.d)||0),i=1<i?"r":i<-1?"l":"";i&&(t=i=="r"?"l":"r",n=N({},e),r=e[i],e.from=r.from,e.to=r.to,e[i]=r[i],n[i]=r[t],(e[t]=n).d=Lr(n)),e.d=Lr(e)}function Lr(n){var t=n.r,n=n.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function Bn(e,t){return w(t).forEach(function(n){e[n]?wn(e[n],t[n]):e[n]=(function r(i){var a,u,l={};for(a in i)te(i,a)&&(u=i[a],l[a]=!u||typeof u!="object"||V.has(u.constructor)?u:r(u));return l})(t[n])}),e}function ar(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&Dr(t[n],e[n])})}qe(jt.prototype,((_e={add:function(e){return wn(this,e),this},addKey:function(e){return gn(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return gn(t,n,n)}),this},hasKey:function(e){var t=In(this).next(e).value;return t&&Re(t.from,e)<=0&&0<=Re(t.to,e)}})[Je]=function(){return In(this)},_e));var nn={},ur={},sr=!1;function Kn(e){Bn(ur,e),sr||(sr=!0,setTimeout(function(){sr=!1,cr(ur,!(ur={}))},0))}function cr(e,t){t===void 0&&(t=!1);var n=new Set;if(e.all)for(var r=0,i=Object.values(nn);r<i.length;r++)Ur(l=i[r],e,n,t);else for(var a in e){var u,l,a=/^idb\:\/\/(.*)\/(.*)\//.exec(a);a&&(u=a[1],a=a[2],l=nn["idb://".concat(u,"/").concat(a)])&&Ur(l,e,n,t)}n.forEach(function(y){return y()})}function Ur(e,t,n,r){for(var i=[],a=0,u=Object.entries(e.queries.query);a<u.length;a++){for(var l=u[a],y=l[0],S=[],v=0,h=l[1];v<h.length;v++){var b=h[v];ar(t,b.obsSet)?b.subscribers.forEach(function(x){return n.add(x)}):r&&S.push(b)}r&&i.push([y,S])}if(r)for(var g=0,m=i;g<m.length;g++){var d=m[g],y=d[0],S=d[1];e.queries.query[y]=S}}function vi(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?nt(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller,i=Math.round(10*e.verno),a=!1;function u(){if(t.openCanceller!==r)throw new A.DatabaseClosed("db.open() was cancelled")}function l(){return new D(function(b,g){if(u(),!n)throw new A.MissingAPI;var m=e.name,d=t.autoSchema||!i?n.open(m):n.open(m,i);if(!d)throw new A.MissingAPI;d.onerror=Gt(g),d.onblocked=X(e._fireOnBlocked),d.onupgradeneeded=X(function(x){var T;v=d.transaction,t.autoSchema&&!e._options.allowEmptyDB?(d.onerror=yn,v.abort(),d.result.close(),(T=n.deleteDatabase(m)).onsuccess=T.onerror=X(function(){g(new A.NoSuchDatabase("Database ".concat(m," doesnt exist")))})):(v.onerror=Gt(g),T=x.oldVersion>Math.pow(2,62)?0:x.oldVersion,h=T<1,e.idbdb=d.result,a&&di(e,v),hi(e,T/10,v,g))},g),d.onsuccess=X(function(){v=null;var x,T,O,K,U,W,H=e.idbdb=d.result,M=Xe(H.objectStoreNames);if(0<M.length)try{var re=H.transaction((U=M).length===1?U[0]:U,"readonly");if(t.autoSchema)W=H,K=re,(O=e).verno=W.version/10,K=O._dbSchema=jn(0,W,K),O._storeNames=Xe(W.objectStoreNames,0),Pn(O,[O._allTables],w(K),K);else if(Cn(e,e._dbSchema,re),T=re,((T=er(jn(0,(x=e).idbdb,T),x._dbSchema)).add.length||T.change.some(function(ne){return ne.add.length||ne.change.length}))&&!a)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),H.close(),i=H.version+1,a=!0,b(l());kn(e,re)}catch{}Rt.push(e),H.onversionchange=X(function(ne){t.vcFired=!0,e.on("versionchange").fire(ne)}),H.onclose=X(function(){e.close({disableAutoOpen:!1})}),h&&(M=e._deps,U=m,rr(W=M.indexedDB)||U===zt||nr(W,M.IDBKeyRange).put({name:U}).catch(ae)),b()},g)}).catch(function(b){switch(b?.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),l();break;case"VersionError":if(0<i)return i=0,l()}return D.reject(b)})}var y,S=t.dbReadyResolve,v=null,h=!1;return D.race([r,(typeof navigator>"u"?D.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(b){function g(){return indexedDB.databases().finally(b)}y=setInterval(g,100),g()}).finally(function(){return clearInterval(y)}):Promise.resolve()).then(l)]).then(function(){return u(),t.onReadyBeingFired=[],D.resolve(ir(function(){return e.on.ready.fire(e.vip)})).then(function b(){var g;if(0<t.onReadyBeingFired.length)return g=t.onReadyBeingFired.reduce(It,ae),t.onReadyBeingFired=[],D.resolve(ir(function(){return g(e.vip)})).then(b)})}).finally(function(){t.openCanceller===r&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(b){t.dbOpenError=b;try{v&&v.abort()}catch{}return r===t.openCanceller&&e._close(),nt(b)}).finally(function(){t.openComplete=!0,S()}).then(function(){var b;return h&&(b={},e.tables.forEach(function(g){g.schema.indexes.forEach(function(m){m.name&&(b["idb://".concat(e.name,"/").concat(g.name,"/").concat(m.name)]=new jt(-1/0,[[[]]]))}),b["idb://".concat(e.name,"/").concat(g.name,"/")]=b["idb://".concat(e.name,"/").concat(g.name,"/:dels")]=new jt(-1/0,[[[]]])}),Qt(vn).fire(b),cr(b,!0)),e})}function lr(e){function t(a){return e.next(a)}var n=i(t),r=i(function(a){return e.throw(a)});function i(a){return function(l){var l=a(l),y=l.value;return l.done?y:y&&typeof y.then=="function"?y.then(n,r):J(y)?Promise.all(y).then(n,r):n(y)}}return i(t)()}function Rn(e,t,n){for(var r=J(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}var mi={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return N(N({},e),{table:function(r){var n=e.table(r),r=n.schema,i={},a=[];function u(b,g,m){var O=bn(b),d=i[O]=i[O]||[],x=b==null?0:typeof b=="string"?1:b.length,T=0<g,O=N(N({},m),{name:T?"".concat(O,"(virtual-from:").concat(m.name,")"):m.name,lowLevelIndex:m,isVirtual:T,keyTail:g,keyLength:x,extractKey:Xn(b),unique:!T&&m.unique});return d.push(O),O.isPrimaryKey||a.push(O),1<x&&u(x===2?b[0]:b.slice(0,x-1),g+1,m),d.sort(function(K,U){return K.keyTail-U.keyTail}),O}var l=u(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[l];for(var y=0,S=r.indexes;y<S.length;y++){var v=S[y];u(v.keyPath,0,v)}function h(b){var g,m=b.query.index;return m.isVirtual?N(N({},b),{query:{index:m.lowLevelIndex,range:(g=b.query.range,m=m.keyTail,{type:g.type===1?2:g.type,lower:Rn(g.lower,g.lowerOpen?e.MAX_KEY:e.MIN_KEY,m),lowerOpen:!0,upper:Rn(g.upper,g.upperOpen?e.MIN_KEY:e.MAX_KEY,m),upperOpen:!0})}}):b}return N(N({},n),{schema:N(N({},r),{primaryKey:l,indexes:a,getIndexByKeyPath:function(b){return(b=i[bn(b)])&&b[0]}}),count:function(b){return n.count(h(b))},query:function(b){return n.query(h(b))},openCursor:function(b){var g=b.query.index,m=g.keyTail,d=g.keyLength;return g.isVirtual?n.openCursor(h(b)).then(function(T){return T&&x(T)}):n.openCursor(b);function x(T){return Object.create(T,{continue:{value:function(O){O!=null?T.continue(Rn(O,b.reverse?e.MAX_KEY:e.MIN_KEY,m)):b.unique?T.continue(T.key.slice(0,d).concat(b.reverse?e.MIN_KEY:e.MAX_KEY,m)):T.continue()}},continuePrimaryKey:{value:function(O,K){T.continuePrimaryKey(Rn(O,e.MAX_KEY,m),K)}},primaryKey:{get:function(){return T.primaryKey}},key:{get:function(){var O=T.key;return d===1?O[0]:O.slice(0,d)}},value:{get:function(){return T.value}}})}}})}})}};function fr(e,t,n,r){return n=n||{},r=r||"",w(e).forEach(function(i){var a,u,l;te(t,i)?(a=e[i],u=t[i],typeof a=="object"&&typeof u=="object"&&a&&u?(l=Ue(a))!==Ue(u)?n[r+i]=t[i]:l==="Object"?fr(a,u,n,r+i+"."):a!==u&&(n[r+i]=t[i]):a!==u&&(n[r+i]=t[i])):n[r+i]=void 0}),w(t).forEach(function(i){te(e,i)||(n[r+i]=t[i])}),n}function pr(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var bi={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return N(N({},e),{table:function(t){var n=e.table(t),r=n.schema.primaryKey;return N(N({},n),{mutate:function(i){var a=C.trans,u=a.table(t).hook,l=u.deleting,y=u.creating,S=u.updating;switch(i.type){case"add":if(y.fire===ae)break;return a._promise("readwrite",function(){return v(i)},!0);case"put":if(y.fire===ae&&S.fire===ae)break;return a._promise("readwrite",function(){return v(i)},!0);case"delete":if(l.fire===ae)break;return a._promise("readwrite",function(){return v(i)},!0);case"deleteRange":if(l.fire===ae)break;return a._promise("readwrite",function(){return(function h(b,g,m){return n.query({trans:b,values:!1,query:{index:r,range:g},limit:m}).then(function(d){var x=d.result;return v({type:"delete",keys:x,trans:b}).then(function(T){return 0<T.numFailures?Promise.reject(T.failures[0]):x.length<m?{failures:[],numFailures:0,lastResult:void 0}:h(b,N(N({},g),{lower:x[x.length-1],lowerOpen:!0}),m)})})})(i.trans,i.range,1e4)},!0)}return n.mutate(i);function v(h){var b,g,m,d=C.trans,x=h.keys||pr(r,h);if(x)return(h=h.type==="add"||h.type==="put"?N(N({},h),{keys:x}):N({},h)).type!=="delete"&&(h.values=$([],h.values)),h.keys&&(h.keys=$([],h.keys)),b=n,m=x,((g=h).type==="add"?Promise.resolve([]):b.getMany({trans:g.trans,keys:m,cache:"immutable"})).then(function(T){var O=x.map(function(K,U){var W,H,M,re=T[U],ne={onerror:null,onsuccess:null};return h.type==="delete"?l.fire.call(ne,K,re,d):h.type==="add"||re===void 0?(W=y.fire.call(ne,K,h.values[U],d),K==null&&W!=null&&(h.keys[U]=K=W,r.outbound||we(h.values[U],r.keyPath,K))):(W=fr(re,h.values[U]),(H=S.fire.call(ne,W,K,re,d))&&(M=h.values[U],Object.keys(H).forEach(function(G){te(M,G)?M[G]=H[G]:we(M,G,H[G])}))),ne});return n.mutate(h).then(function(K){for(var U=K.failures,W=K.results,H=K.numFailures,K=K.lastResult,M=0;M<x.length;++M){var re=(W||x)[M],ne=O[M];re==null?ne.onerror&&ne.onerror(U[M]):ne.onsuccess&&ne.onsuccess(h.type==="put"&&T[M]?h.values[M]:re)}return{failures:U,results:W,numFailures:H,lastResult:K}}).catch(function(K){return O.forEach(function(U){return U.onerror&&U.onerror(K)}),Promise.reject(K)})});throw new Error("Keys missing")}}})}})}};function qr(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var r=[],i=0,a=0;i<t.keys.length&&a<e.length;++i)Re(t.keys[i],e[a])===0&&(r.push(n?Te(t.values[i]):t.values[i]),++a);return r.length===e.length?r:null}catch{return null}}var gi={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return N(N({},n),{getMany:function(r){var i;return r.cache?(i=qr(r.keys,r.trans._cache,r.cache==="clone"))?D.resolve(i):n.getMany(r).then(function(a){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?Te(a):a},a}):n.getMany(r)},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}};function Mr(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function Vr(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var wi={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,n=new jt(e.MIN_KEY,e.MAX_KEY);return N(N({},e),{transaction:function(r,i,a){if(C.subscr&&i!=="readonly")throw new A.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(C.querier));return e.transaction(r,i,a)},table:function(r){function i(x){var d,x=x.query;return[d=x.index,new jt((d=(x=x.range).lower)!=null?d:e.MIN_KEY,(d=x.upper)!=null?d:e.MAX_KEY)]}var a=e.table(r),u=a.schema,l=u.primaryKey,y=u.indexes,S=l.extractKey,v=l.outbound,h=l.autoIncrement&&y.filter(function(m){return m.compound&&m.keyPath.includes(l.keyPath)}),b=N(N({},a),{mutate:function(m){function d(ue){return ue="idb://".concat(t,"/").concat(r,"/").concat(ue),U[ue]||(U[ue]=new jt)}var x,T,O,K=m.trans,U=m.mutatedParts||(m.mutatedParts={}),W=d(""),H=d(":dels"),M=m.type,ne=m.type==="deleteRange"?[m.range]:m.type==="delete"?[m.keys]:m.values.length<50?[pr(l,m).filter(function(ue){return ue}),m.values]:[],re=ne[0],ne=ne[1],G=m.trans._cache;return J(re)?(W.addKeys(re),(M=M==="delete"||re.length===ne.length?qr(re,G):null)||H.addKeys(re),(M||ne)&&(x=d,T=M,O=ne,u.indexes.forEach(function(ue){var Le=x(ue.name||"");function Ye(ke){return ke!=null?ue.extractKey(ke):null}function ye(ke){ue.multiEntry&&J(ke)?ke.forEach(function(st){return Le.addKey(st)}):Le.addKey(ke)}(T||O).forEach(function(ke,ft){var qt=T&&Ye(T[ft]),ft=O&&Ye(O[ft]);Re(qt,ft)!==0&&(qt!=null&&ye(qt),ft!=null)&&ye(ft)})}))):re?(ne={from:(G=re.lower)!=null?G:e.MIN_KEY,to:(M=re.upper)!=null?M:e.MAX_KEY},H.add(ne),W.add(ne)):(W.add(n),H.add(n),u.indexes.forEach(function(ue){return d(ue.name).add(n)})),a.mutate(m).then(function(ue){return!re||m.type!=="add"&&m.type!=="put"||(W.addKeys(ue.results),h&&h.forEach(function(Le){for(var Ye=m.values.map(function(qt){return Le.extractKey(qt)}),ye=Le.keyPath.findIndex(function(qt){return qt===l.keyPath}),ke=0,st=ue.results.length;ke<st;++ke)Ye[ke][ye]=ue.results[ke];d(Le.name).addKeys(Ye)})),K.mutatedParts=Bn(K.mutatedParts||{},U),ue})}}),g={get:function(m){return[l,new jt(m.key)]},getMany:function(m){return[l,new jt().addKeys(m.keys)]},count:i,query:i,openCursor:i};return w(g).forEach(function(m){b[m]=function(d){var x=C.subscr,T=!!x,O=Mr(C,a)&&Vr(m,d)?d.obsSet={}:x;if(T){var K,x=function(ne){return ne="idb://".concat(t,"/").concat(r,"/").concat(ne),O[ne]||(O[ne]=new jt)},U=x(""),W=x(":dels"),T=g[m](d),H=T[0],T=T[1];if((m==="query"&&H.isPrimaryKey&&!d.values?W:x(H.name||"")).add(T),!H.isPrimaryKey){if(m!=="count")return K=m==="query"&&v&&d.values&&a.query(N(N({},d),{values:!1})),a[m].apply(this,arguments).then(function(ne){if(m==="query"){if(v&&d.values)return K.then(function(Ye){return Ye=Ye.result,U.addKeys(Ye),ne});var G=d.values?ne.result.map(S):ne.result;(d.values?U:W).addKeys(G)}else{var ue,Le;if(m==="openCursor")return Le=d.values,(ue=ne)&&Object.create(ue,{key:{get:function(){return W.addKey(ue.primaryKey),ue.key}},primaryKey:{get:function(){var Ye=ue.primaryKey;return W.addKey(Ye),Ye}},value:{get:function(){return Le&&U.addKey(ue.primaryKey),ue.value}}})}return ne});W.add(n)}}return a[m].apply(this,arguments)}}),b}})}};function $r(e,t,n){var r;return n.numFailures===0?t:t.type==="deleteRange"||(r=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1,n.numFailures===r)?null:(r=N({},t),J(r.keys)&&(r.keys=r.keys.filter(function(i,a){return!(a in n.failures)})),"values"in r&&J(r.values)&&(r.values=r.values.filter(function(i,a){return!(a in n.failures)})),r)}function hr(e,t){return n=e,((r=t).lower===void 0||(r.lowerOpen?0<Re(n,r.lower):0<=Re(n,r.lower)))&&(n=e,(r=t).upper===void 0||(r.upperOpen?Re(n,r.upper)<0:Re(n,r.upper)<=0));var n,r}function Yr(e,t,n,r,i,a){var u,l,y,S,v,h;return!n||n.length===0||(u=t.query.index,l=u.multiEntry,y=t.query.range,S=r.schema.primaryKey.extractKey,v=u.extractKey,h=(u.lowLevelIndex||u).extractKey,(r=n.reduce(function(b,g){var m=b,d=[];if(g.type==="add"||g.type==="put")for(var x=new jt,T=g.values.length-1;0<=T;--T){var O,K=g.values[T],U=S(K);!x.hasKey(U)&&(O=v(K),l&&J(O)?O.some(function(ne){return hr(ne,y)}):hr(O,y))&&(x.addKey(U),d.push(K))}switch(g.type){case"add":var W=new jt().addKeys(t.values?b.map(function(G){return S(G)}):b),m=b.concat(t.values?d.filter(function(G){return G=S(G),!W.hasKey(G)&&(W.addKey(G),!0)}):d.map(function(G){return S(G)}).filter(function(G){return!W.hasKey(G)&&(W.addKey(G),!0)}));break;case"put":var H=new jt().addKeys(g.values.map(function(G){return S(G)}));m=b.filter(function(G){return!H.hasKey(t.values?S(G):G)}).concat(t.values?d:d.map(function(G){return S(G)}));break;case"delete":var M=new jt().addKeys(g.keys);m=b.filter(function(G){return!M.hasKey(t.values?S(G):G)});break;case"deleteRange":var re=g.range;m=b.filter(function(G){return!hr(S(G),re)})}return m},e))===e)?e:(r.sort(function(b,g){return Re(h(b),h(g))||Re(S(b),S(g))}),t.limit&&t.limit<1/0&&(r.length>t.limit?r.length=t.limit:e.length===t.limit&&r.length<t.limit&&(i.dirty=!0)),a?Object.freeze(r):r)}function Gr(e,t){return Re(e.lower,t.lower)===0&&Re(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function _i(e,t){return((n,r,i,a)=>{if(n===void 0)return r!==void 0?-1:0;if(r===void 0)return 1;if((n=Re(n,r))===0){if(i&&a)return 0;if(i)return 1;if(a)return-1}return n})(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=((n,r,i,a)=>{if(n===void 0)return r!==void 0?1:0;if(r===void 0)return-1;if((n=Re(n,r))===0){if(i&&a)return 0;if(i)return-1;if(a)return 1}return n})(e.upper,t.upper,e.upperOpen,t.upperOpen)}function Oi(e,t,n,r){e.subscribers.add(n),r.addEventListener("abort",function(){var i,a;e.subscribers.delete(n),e.subscribers.size===0&&(i=e,a=t,setTimeout(function(){i.subscribers.size===0&&lt(a,i)},3e3))})}var Si={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return N(N({},e),{transaction:function(n,r,i){var a,u,l=e.transaction(n,r,i);return r==="readwrite"&&(i=(a=new AbortController).signal,l.addEventListener("abort",(u=function(y){return function(){if(a.abort(),r==="readwrite"){for(var S=new Set,v=0,h=n;v<h.length;v++){var b=h[v],g=nn["idb://".concat(t,"/").concat(b)];if(g){var m=e.table(b),d=g.optimisticOps.filter(function(ue){return ue.trans===l});if(l._explicit&&y&&l.mutatedParts)for(var x=0,T=Object.values(g.queries.query);x<T.length;x++)for(var O=0,K=(H=T[x]).slice();O<K.length;O++)ar((M=K[O]).obsSet,l.mutatedParts)&&(lt(H,M),M.subscribers.forEach(function(ue){return S.add(ue)}));else if(0<d.length){g.optimisticOps=g.optimisticOps.filter(function(ue){return ue.trans!==l});for(var U=0,W=Object.values(g.queries.query);U<W.length;U++)for(var H,M,re,ne=0,G=(H=W[U]).slice();ne<G.length;ne++)(M=G[ne]).res!=null&&l.mutatedParts&&(y&&!M.dirty?(re=Object.isFrozen(M.res),re=Yr(M.res,M.req,d,m,M,re),M.dirty?(lt(H,M),M.subscribers.forEach(function(ue){return S.add(ue)})):re!==M.res&&(M.res=re,M.promise=D.resolve({result:re}))):(M.dirty&&lt(H,M),M.subscribers.forEach(function(ue){return S.add(ue)})))}}}S.forEach(function(ue){return ue()})}}})(!1),{signal:i}),l.addEventListener("error",u(!1),{signal:i}),l.addEventListener("complete",u(!0),{signal:i})),l},table:function(n){var r=e.table(n),i=r.schema.primaryKey;return N(N({},r),{mutate:function(a){var u,l=C.trans;return!i.outbound&&l.db._options.cache!=="disabled"&&!l.explicit&&l.idbtrans.mode==="readwrite"&&(u=nn["idb://".concat(t,"/").concat(n)])?(l=r.mutate(a),a.type!=="add"&&a.type!=="put"||!(50<=a.values.length||pr(i,a).some(function(y){return y==null}))?(u.optimisticOps.push(a),a.mutatedParts&&Kn(a.mutatedParts),l.then(function(y){0<y.numFailures&&(lt(u.optimisticOps,a),(y=$r(0,a,y))&&u.optimisticOps.push(y),a.mutatedParts)&&Kn(a.mutatedParts)}),l.catch(function(){lt(u.optimisticOps,a),a.mutatedParts&&Kn(a.mutatedParts)})):l.then(function(y){var S=$r(0,N(N({},a),{values:a.values.map(function(v,h){var b;return y.failures[h]?v:(we(b=(b=i.keyPath)!=null&&b.includes(".")?Te(v):N({},v),i.keyPath,y.results[h]),b)})}),y);u.optimisticOps.push(S),queueMicrotask(function(){return a.mutatedParts&&Kn(a.mutatedParts)})}),l):r.mutate(a)},query:function(a){var u,l,y,S,v,h,b;return Mr(C,r)&&Vr("query",a)?(u=((y=C.trans)==null?void 0:y.db._options.cache)==="immutable",l=(y=C).requery,y=y.signal,h=((g,m,d,x)=>{var T=nn["idb://".concat(g,"/").concat(m)];if(!T)return[];if(!(g=T.queries[d]))return[null,!1,T,null];var O=g[(x.query?x.query.index.name:null)||""];if(!O)return[null,!1,T,null];switch(d){case"query":var K=O.find(function(U){return U.req.limit===x.limit&&U.req.values===x.values&&Gr(U.req.query.range,x.query.range)});return K?[K,!0,T,O]:[O.find(function(U){return("limit"in U.req?U.req.limit:1/0)>=x.limit&&(!x.values||U.req.values)&&_i(U.req.query.range,x.query.range)}),!1,T,O];case"count":return K=O.find(function(U){return Gr(U.req.query.range,x.query.range)}),[K,!!K,T,O]}})(t,n,"query",a),b=h[0],S=h[2],v=h[3],b&&h[1]?b.obsSet=a.obsSet:(h=r.query(a).then(function(g){var m=g.result;if(b&&(b.res=m),u){for(var d=0,x=m.length;d<x;++d)Object.freeze(m[d]);Object.freeze(m)}else g.result=Te(m);return g}).catch(function(g){return v&&b&&lt(v,b),Promise.reject(g)}),b={obsSet:a.obsSet,promise:h,subscribers:new Set,type:"query",req:a,dirty:!1},v?v.push(b):(v=[b],(S=S||(nn["idb://".concat(t,"/").concat(n)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[a.query.index.name||""]=v)),Oi(b,v,l,y),b.promise.then(function(g){return{result:Yr(g.result,a,S?.optimisticOps,r,b,u)}})):r.query(a)}})}})}};function Dn(e,t){return new Proxy(e,{get:function(n,r,i){return r==="db"?t:Reflect.get(n,r,i)}})}ht.prototype.version=function(e){if(isNaN(e)||e<.1)throw new A.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new A.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter(function(r){return r._cfg.version===e})[0];return n||(n=new this.Version(e),t.push(n),t.sort(pi),n.stores({}),this._state.autoSchema=!1),n},ht.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||C.letThrough||this._vip)?e():new D(function(n,r){if(t._state.openComplete)return r(new A.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void r(new A.DatabaseClosed);t.open().catch(ae)}t._state.dbReadyPromise.then(n,r)}).then(e)},ht.prototype.use=function(i){var t=i.stack,n=i.create,r=i.level,i=i.name,a=(i&&this.unuse({stack:t,name:i}),this._middlewares[t]||(this._middlewares[t]=[]));return a.push({stack:t,create:n,level:r??10,name:i}),a.sort(function(u,l){return u.level-l.level}),this},ht.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(i){return r?i.create!==r:!!n&&i.name!==n})),this},ht.prototype.open=function(){var e=this;return Vt(Y,function(){return vi(e)})},ht.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var e=this._state,t=Rt.indexOf(this);if(0<=t&&Rt.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new D(function(n){e.dbReadyResolve=n}),e.openCanceller=new D(function(n,r){e.cancelOpen=r}))},ht.prototype.close=function(t){var t=(t===void 0?{disableAutoOpen:!0}:t).disableAutoOpen,n=this._state;t?(n.isBeingOpened&&n.cancelOpen(new A.DatabaseClosed),this._close(),n.autoOpen=!1,n.dbOpenError=new A.DatabaseClosed):(this._close(),n.autoOpen=this._options.autoOpen||n.isBeingOpened,n.openComplete=!1,n.dbOpenError=null)},ht.prototype.delete=function(e){var t=this,n=(e===void 0&&(e={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),r=this._state;return new D(function(i,a){function u(){t.close(e);var l=t._deps.indexedDB.deleteDatabase(t.name);l.onsuccess=X(function(){var y,S,v;y=t._deps,S=t.name,rr(v=y.indexedDB)||S===zt||nr(v,y.IDBKeyRange).delete(S).catch(ae),i()}),l.onerror=Gt(a),l.onblocked=t._fireOnBlocked}if(n)throw new A.InvalidArgument("Invalid closeOptions argument to db.delete()");r.isBeingOpened?r.dbReadyPromise.then(u):u()})},ht.prototype.backendDB=function(){return this.idbdb},ht.prototype.isOpen=function(){return this.idbdb!==null},ht.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},ht.prototype.hasFailed=function(){return this._state.dbOpenError!==null},ht.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(ht.prototype,"tables",{get:function(){var e=this;return w(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),ht.prototype.transaction=function(){var e=(function(t,n,r){var i=arguments.length;if(i<2)throw new A.InvalidArgument("Too few arguments");for(var a=new Array(i-1);--i;)a[i-1]=arguments[i];return r=a.pop(),[t,f(a),r]}).apply(this,arguments);return this._transaction.apply(this,e)},ht.prototype._transaction=function(e,t,n){var r,i,a=this,u=C.trans,l=(u&&u.db===this&&e.indexOf("!")===-1||(u=null),e.indexOf("?")!==-1);e=e.replace("!","").replace("?","");try{if(i=t.map(function(S){if(S=S instanceof a.Table?S.name:S,typeof S!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return S}),e=="r"||e===Yn)r=Yn;else{if(e!="rw"&&e!=Gn)throw new A.InvalidArgument("Invalid transaction mode: "+e);r=Gn}if(u){if(u.mode===Yn&&r===Gn){if(!l)throw new A.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");u=null}u&&i.forEach(function(S){if(u&&u.storeNames.indexOf(S)===-1){if(!l)throw new A.SubTransaction("Table "+S+" not included in parent transaction.");u=null}}),l&&u&&!u.active&&(u=null)}}catch(S){return u?u._promise(null,function(v,h){h(S)}):nt(S)}var y=(function S(v,h,b,g,m){return D.resolve().then(function(){var O=C.transless||C,d=v._createTransaction(h,b,v._dbSchema,g),O=(d.explicit=!0,{trans:d,transless:O});if(g)d.idbtrans=g.idbtrans;else try{d.create(),d.idbtrans._explicit=!0,v._state.PR1398_maxLoop=3}catch(K){return K.name===R.InvalidState&&v.isOpen()&&0<--v._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),v.close({disableAutoOpen:!1}),v.open().then(function(){return S(v,h,b,null,m)})):nt(K)}var x,T=He(m),O=(T&&gt(),D.follow(function(){var K;(x=m.call(d,d))&&(T?(K=Fe.bind(null,null),x.then(K,K)):typeof x.next=="function"&&typeof x.throw=="function"&&(x=lr(x)))},O));return(x&&typeof x.then=="function"?D.resolve(x).then(function(K){return d.active?K:nt(new A.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):O.then(function(){return x})).then(function(K){return g&&d._resolve(),d._completion.then(function(){return K})}).catch(function(K){return d._reject(K),nt(K)})})}).bind(null,this,r,i,u,n);return u?u._promise(r,y,"lock"):C.trans?Vt(C.transless,function(){return a._whenReady(y)}):this._whenReady(y)},ht.prototype.table=function(e){if(te(this._allTables,e))return this._allTables[e];throw new A.InvalidTable("Table ".concat(e," does not exist"))};var Wt=ht;function ht(e,t){var n,r,i,a,u,l=this,y=(this._middlewares={},this.verno=0,ht.dependencies),y=(this._options=t=N({addons:ht.addons,autoOpen:!0,indexedDB:y.indexedDB,IDBKeyRange:y.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},t.addons),S=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ae,dbReadyPromise:null,cancelOpen:ae,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen}),v=(S.dbReadyPromise=new D(function(h){S.dbReadyResolve=h}),S.openCanceller=new D(function(h,b){S.cancelOpen=b}),this._state=S,this.name=e,this.on=hn(this,"populate","blocked","versionchange","close",{ready:[It,ae]}),this.once=function(h,b){var g=function(){for(var m=[],d=0;d<arguments.length;d++)m[d]=arguments[d];l.on(h).unsubscribe(g),b.apply(l,m)};return l.on(h,g)},this.on.ready.subscribe=se(this.on.ready.subscribe,function(h){return function(b,g){ht.vip(function(){var m,d=l._state;d.openComplete?(d.dbOpenError||D.resolve().then(b),g&&h(b)):d.onReadyBeingFired?(d.onReadyBeingFired.push(b),g&&h(b)):(h(b),m=l,g||h(function x(){m.on.ready.unsubscribe(b),m.on.ready.unsubscribe(x)}))})}}),this.Collection=(n=this,dn(oi.prototype,function(x,d){this.db=n;var g=_r,m=null;if(d)try{g=d()}catch(O){m=O}var d=x._ctx,x=d.table,T=x.hook.reading.fire;this._ctx={table:x,index:d.index,isPrimKey:!d.index||x.schema.primKey.keyPath&&d.index===x.schema.primKey.name,range:g,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:m,or:d.or,valueMapper:T!==Ee?T:null}})),this.Table=(r=this,dn(Tr.prototype,function(h,b,g){this.db=r,this._tx=g,this.name=h,this.schema=b,this.hook=r._allTables[h]?r._allTables[h].hook:hn(null,{creating:[mt,ae],reading:[Ce,Ee],updating:[Ct,ae],deleting:[kt,ae]})})),this.Transaction=(i=this,dn(si.prototype,function(h,b,g,m,d){var x=this;h!=="readonly"&&b.forEach(function(T){T=(T=g[T])==null?void 0:T.yProps,T&&(b=b.concat(T.map(function(O){return O.updatesTable})))}),this.db=i,this.mode=h,this.storeNames=b,this.schema=g,this.chromeTransactionDurability=m,this.idbtrans=null,this.on=hn(this,"complete","error","abort"),this.parent=d||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new D(function(T,O){x._resolve=T,x._reject=O}),this._completion.then(function(){x.active=!1,x.on.complete.fire()},function(T){var O=x.active;return x.active=!1,x.on.error.fire(T),x.parent?x.parent._reject(T):O&&x.idbtrans&&x.idbtrans.abort(),nt(T)})})),this.Version=(a=this,dn(yi.prototype,function(h){this.db=a,this._cfg={version:h,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(u=this,dn(Cr.prototype,function(h,b,g){if(this.db=u,this._ctx={table:h,index:b===":id"?null:b,or:g},this._cmp=this._ascending=Re,this._descending=function(m,d){return Re(d,m)},this._max=function(m,d){return 0<Re(m,d)?m:d},this._min=function(m,d){return Re(m,d)<0?m:d},this._IDBKeyRange=u._deps.IDBKeyRange,!this._IDBKeyRange)throw new A.MissingAPI})),this.on("versionchange",function(h){0<h.newVersion?console.warn("Another connection wants to upgrade database '".concat(l.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(l.name,"'. Closing db now to resume the delete request.")),l.close({disableAutoOpen:!1})}),this.on("blocked",function(h){!h.newVersion||h.newVersion<h.oldVersion?console.warn("Dexie.delete('".concat(l.name,"') was blocked")):console.warn("Upgrade '".concat(l.name,"' blocked by other connection holding version ").concat(h.oldVersion/10))}),this._maxKey=mn(t.IDBKeyRange),this._createTransaction=function(h,b,g,m){return new l.Transaction(h,b,g,l._options.chromeTransactionDurability,m)},this._fireOnBlocked=function(h){l.on("blocked").fire(h),Rt.filter(function(b){return b.name===l.name&&b!==l&&!b._state.vcFired}).map(function(b){return b.on("versionchange").fire(h)})},this.use(gi),this.use(Si),this.use(wi),this.use(mi),this.use(bi),new Proxy(this,{get:function(h,b,g){var m;return b==="_vip"||(b==="table"?function(d){return Dn(l.table(d),v)}:(m=Reflect.get(h,b,g))instanceof Tr?Dn(m,v):b==="tables"?m.map(function(d){return Dn(d,v)}):b==="_createTransaction"?function(){return Dn(m.apply(this,arguments),v)}:m)}}));this.vip=v,y.forEach(function(h){return h(l)})}var Fn,cn=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Ei=(dr.prototype.subscribe=function(e,t,n){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:n})},dr.prototype[cn]=function(){return this},dr);function dr(e){this._subscribe=e}try{Fn={indexedDB:k.indexedDB||k.mozIndexedDB||k.webkitIndexedDB||k.msIndexedDB,IDBKeyRange:k.IDBKeyRange||k.webkitIDBKeyRange}}catch{Fn={indexedDB:null,IDBKeyRange:null}}function Jr(e){var t,n=!1,r=new Ei(function(i){var a=He(e),u,l=!1,y={},S={},v={get closed(){return l},unsubscribe:function(){l||(l=!0,u&&u.abort(),h&&Qt.storagemutated.unsubscribe(g))}},h=(i.start&&i.start(v),!1),b=function(){return Yt(m)},g=function(d){Bn(y,d),ar(S,y)&&b()},m=function(){var d,x,T;!l&&Fn.indexedDB&&(y={},d={},u&&u.abort(),u=new AbortController,T=(O=>{var K=at();try{a&&gt();var U=je(e,O);return U=a?U.finally(Fe):U}finally{K&&ie()}})(x={subscr:d,signal:u.signal,requery:b,querier:e,trans:null}),Promise.resolve(T).then(function(O){n=!0,t=O,l||x.signal.aborted||(y={},(K=>{for(var U in K)if(te(K,U))return;return 1})(S=d)||h||(Qt(vn,g),h=!0),Yt(function(){return!l&&i.next&&i.next(O)}))},function(O){n=!1,["DatabaseClosedError","AbortError"].includes(O?.name)||l||Yt(function(){l||i.error&&i.error(O)})}))};return setTimeout(b,0),v});return r.hasValue=function(){return n},r.getValue=function(){return t},r}var rn=Wt;function yr(e){var t=Xt;try{Xt=!0,Qt.storagemutated.fire(e),cr(e,!0)}finally{Xt=t}}qe(rn,N(N({},it),{delete:function(e){return new rn(e,{addons:[]}).delete()},exists:function(e){return new rn(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return t=rn.dependencies,n=t.indexedDB,t=t.IDBKeyRange,(rr(n)?Promise.resolve(n.databases()).then(function(r){return r.map(function(i){return i.name}).filter(function(i){return i!==zt})}):nr(n,t).toCollection().primaryKeys()).then(e)}catch{return nt(new A.MissingAPI)}var t,n},defineClass:function(){return function(e){ce(this,e)}},ignoreTransaction:function(e){return C.trans?Vt(C.transless,e):e()},vip:ir,async:function(e){return function(){try{var t=lr(e.apply(this,arguments));return t&&typeof t.then=="function"?t:D.resolve(t)}catch(n){return nt(n)}}},spawn:function(e,t,n){try{var r=lr(e.apply(n,t||[]));return r&&typeof r.then=="function"?r:D.resolve(r)}catch(i){return nt(i)}},currentTransaction:{get:function(){return C.trans||null}},waitFor:function(e,t){return e=D.resolve(typeof e=="function"?rn.ignoreTransaction(e):e).timeout(t||6e4),C.trans?C.trans.waitFor(e):e},Promise:D,debug:{get:function(){return dt},set:function(e){Pt(e)}},derive:ge,extend:ce,props:qe,override:se,Events:hn,on:Qt,liveQuery:Jr,extendObservabilitySet:Bn,getByKeyPath:xe,setByKeyPath:we,delByKeyPath:function(e,t){typeof t=="string"?we(e,t,void 0):"length"in t&&[].map.call(t,function(n){we(e,n,void 0)})},shallowClone:Ot,deepClone:Te,getObjectDiff:fr,cmp:Re,asap:me,minKey:-1/0,addons:[],connections:Rt,errnames:R,dependencies:Fn,cache:nn,semVer:"4.3.0",version:"4.3.0".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,2*n)})})),rn.maxKey=mn(rn.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Qt(vn,function(e){Xt||(e=new CustomEvent(Wn,{detail:e}),Xt=!0,dispatchEvent(e),Xt=!1)}),addEventListener(Wn,function(e){e=e.detail,Xt||yr(e)}));var ln,Xt=!1,zr=function(){};return typeof BroadcastChannel<"u"&&((zr=function(){(ln=new BroadcastChannel(Wn)).onmessage=function(e){return e.data&&yr(e.data)}})(),typeof ln.unref=="function"&&ln.unref(),Qt(vn,function(e){Xt||ln.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!Wt.disableBfCache&&e.persisted){dt&&console.debug("Dexie: handling persisted pagehide"),ln?.close();for(var t=0,n=Rt;t<n.length;t++)n[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!Wt.disableBfCache&&e.persisted&&(dt&&console.debug("Dexie: handling persisted pageshow"),zr(),yr({all:new jt(-1/0,[[]])}))})),D.rejectionMapper=function(e,t){return!e||e instanceof ve||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Q[e.name]?e:(t=new Q[e.name](t||e.message,e),"stack"in e&&be(t,"stack",{get:function(){return this.inner.stack}}),t)},Pt(dt),N(Wt,Object.freeze({__proto__:null,Dexie:Wt,Entity:Or,PropModification:pn,RangeSet:jt,add:function(e){return new pn({add:e})},cmp:Re,default:Wt,liveQuery:Jr,mergeRanges:wn,rangesOverlap:Dr,remove:function(e){return new pn({remove:e})},replacePrefix:function(e,t){return new pn({replacePrefix:[e,t]})}}),{default:Wt}),Wt})})(Un)),Un.exports}var Pi=ki();const mr=xi(Pi),Hr=Symbol.for("Dexie"),wt=globalThis[Hr]||(globalThis[Hr]=mr);if(mr.semVer!==wt.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${mr.semVer} and ${wt.semVer}`);const{liveQuery:Gi,mergeRanges:Ji,rangesOverlap:zi,RangeSet:Wi,cmp:Hi,Entity:Qi,PropModification:Xi,replacePrefix:Zi,add:eo,remove:to,DexieYProvider:no}=wt;function Ni(q,L,P){var N,$;typeof q=="function"?(N=L||[],$=P):(N=[],$=L);var k=_n.useRef({hasResult:!1,result:$,error:null}),w=_n.useReducer(function(E){return E+1},0);w[0];var J=w[1],ce=_n.useMemo(function(){var E=typeof q=="function"?q():q;if(!E||typeof E.subscribe!="function")throw q===E?new TypeError("Given argument to useObservable() was neither a valid observable nor a function."):new TypeError("Observable factory given to useObservable() did not return a valid observable.");if(!k.current.hasResult&&typeof window<"u"&&(typeof E.hasValue!="function"||E.hasValue()))if(typeof E.getValue=="function")k.current.result=E.getValue(),k.current.hasResult=!0;else{var ee=E.subscribe(function(te){k.current.result=te,k.current.hasResult=!0});typeof ee=="function"?ee():ee.unsubscribe()}return E},N);if(_n.useDebugValue(k.current.result),_n.useEffect(function(){var E=ce.subscribe(function(ee){var te=k.current;(te.error!==null||te.result!==ee)&&(te.error=null,te.result=ee,te.hasResult=!0,J())},function(ee){var te=k.current;te.error!==ee&&(te.error=ee,J())});return typeof E=="function"?E:E.unsubscribe.bind(E)},N),k.current.error)throw k.current.error;return k.current.result}function ro(q,L,P){return Ni(function(){return wt.liveQuery(q)},L||[],P)}typeof FinalizationRegistry<"u"&&new FinalizationRegistry(function(q){var L=wt.DexieYProvider;L&&L.release(q)});var Qr={};var Mn=function(){return Mn=Object.assign||function(L){for(var P,N=1,$=arguments.length;N<$;N++){P=arguments[N];for(var k in P)Object.prototype.hasOwnProperty.call(P,k)&&(L[k]=P[k])}return L},Mn.apply(this,arguments)};function Zt(q,L,P,N){function $(k){return k instanceof P?k:new P(function(w){w(k)})}return new(P||(P=Promise))(function(k,w){function J(ee){try{E(N.next(ee))}catch(te){w(te)}}function ce(ee){try{E(N.throw(ee))}catch(te){w(te)}}function E(ee){ee.done?k(ee.value):$(ee.value).then(J,ce)}E((N=N.apply(q,[])).next())})}function $t(q,L){var P={label:0,sent:function(){if(k[0]&1)throw k[1];return k[1]},trys:[],ops:[]},N,$,k,w;return w={next:J(0),throw:J(1),return:J(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function J(E){return function(ee){return ce([E,ee])}}function ce(E){if(N)throw new TypeError("Generator is already executing.");for(;P;)try{if(N=1,$&&(k=E[0]&2?$.return:E[0]?$.throw||((k=$.return)&&k.call($),0):$.next)&&!(k=k.call($,E[1])).done)return k;switch($=0,k&&(E=[E[0]&2,k.value]),E[0]){case 0:case 1:k=E;break;case 4:return P.label++,{value:E[1],done:!1};case 5:P.label++,$=E[1],E=[0];continue;case 7:E=P.ops.pop(),P.trys.pop();continue;default:if(k=P.trys,!(k=k.length>0&&k[k.length-1])&&(E[0]===6||E[0]===2)){P=0;continue}if(E[0]===3&&(!k||E[1]>k[0]&&E[1]<k[3])){P.label=E[1];break}if(E[0]===6&&P.label<k[1]){P.label=k[1],k=E;break}if(k&&P.label<k[2]){P.label=k[2],P.ops.push(E);break}k[2]&&P.ops.pop(),P.trys.pop();continue}E=L.call(q,P)}catch(ee){E=[6,ee],$=0}finally{N=k=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}}function ji(q){var L=[q.schema.primKey].concat(q.schema.indexes);return L.map(function(P){return P.src}).join(",")}function Ci(q){for(var L={},P=0,N=q.tables;P<N.length;P++){var $=N[P];L[$.name]=$.schema}return L}function Xr(q,L){return new Promise(function(P,N){var $=new FileReader;$.onabort=function(k){return N(new Error("file read aborted"))},$.onerror=function(k){return N(k.target.error)},$.onload=function(k){return P(k.target.result)},L==="binary"?$.readAsArrayBuffer(q):$.readAsText(q)})}function Zr(q,L){if(typeof FileReaderSync>"u")throw new Error("FileReaderSync missing. Reading blobs synchronously requires code to run from within a web worker. Use TSON.encapsulateAsync() to do it from the main thread.");var P=new FileReaderSync,N=L==="binary"?P.readAsArrayBuffer(q):P.readAsText(q);return N}var br=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function wr(q,L){return L={exports:{}},q(L,L.exports),L.exports}var $n=wr(function(q,L){(function(P,N){q.exports=N()})(br,(function(){function P(I){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?P=function(R){return typeof R}:P=function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},P(I)}function N(I,R,F,A,Q,ae,Ee){try{var Ce=I[ae](Ee),fe=Ce.value}catch(mt){F(mt);return}Ce.done?R(fe):Promise.resolve(fe).then(A,Q)}function $(I){return function(){var R=this,F=arguments;return new Promise(function(A,Q){var ae=I.apply(R,F);function Ee(fe){N(ae,A,Q,Ee,Ce,"next",fe)}function Ce(fe){N(ae,A,Q,Ee,Ce,"throw",fe)}Ee(void 0)})}}function k(I,R){if(!(I instanceof R))throw new TypeError("Cannot call a class as a function")}function w(I,R){for(var F=0;F<R.length;F++){var A=R[F];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(I,A.key,A)}}function J(I,R,F){return R&&w(I.prototype,R),I}function ce(I,R,F){return R in I?Object.defineProperty(I,R,{value:F,enumerable:!0,configurable:!0,writable:!0}):I[R]=F,I}function E(I,R){var F=Object.keys(I);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(I);R&&(A=A.filter(function(Q){return Object.getOwnPropertyDescriptor(I,Q).enumerable})),F.push.apply(F,A)}return F}function ee(I){for(var R=1;R<arguments.length;R++){var F=arguments[R]!=null?arguments[R]:{};R%2?E(Object(F),!0).forEach(function(A){ce(I,A,F[A])}):Object.getOwnPropertyDescriptors?Object.defineProperties(I,Object.getOwnPropertyDescriptors(F)):E(Object(F)).forEach(function(A){Object.defineProperty(I,A,Object.getOwnPropertyDescriptor(F,A))})}return I}function te(I,R){return be(I)||Me(I,R)||Xe()}function qe(I){return Qe(I)||ge(I)||_t()}function Qe(I){if(Array.isArray(I)){for(var R=0,F=new Array(I.length);R<I.length;R++)F[R]=I[R];return F}}function be(I){if(Array.isArray(I))return I}function ge(I){if(Symbol.iterator in Object(I)||Object.prototype.toString.call(I)==="[object Arguments]")return Array.from(I)}function Me(I,R){if(Symbol.iterator in Object(I)||Object.prototype.toString.call(I)==="[object Arguments]"){var F=[],A=!0,Q=!1,ae=void 0;try{for(var Ee=I[Symbol.iterator](),Ce;!(A=(Ce=Ee.next()).done)&&(F.push(Ce.value),!(R&&F.length===R));A=!0);}catch(fe){Q=!0,ae=fe}finally{try{!A&&Ee.return!=null&&Ee.return()}finally{if(Q)throw ae}}return F}}function _t(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function Xe(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var se=function I(R){k(this,I),this.p=new Promise(R)};se.__typeson__type__="TypesonPromise",typeof Symbol<"u"&&(se.prototype[Symbol.toStringTag]="TypesonPromise"),se.prototype.then=function(I,R){var F=this;return new se(function(A,Q){F.p.then(function(ae){A(I?I(ae):ae)}).catch(function(ae){return R?R(ae):Promise.reject(ae)}).then(A,Q)})},se.prototype.catch=function(I){return this.then(null,I)},se.resolve=function(I){return new se(function(R){R(I)})},se.reject=function(I){return new se(function(R,F){F(I)})},["all","race"].forEach(function(I){se[I]=function(R){return new se(function(F,A){Promise[I](R.map(function(Q){return Q&&Q.constructor&&Q.constructor.__typeson__type__==="TypesonPromise"?Q.p:Q})).then(F,A)})}});var pt={},me=pt.toString,xe={}.hasOwnProperty,we=Object.getPrototypeOf,Ot=xe.toString;function j(I,R){return Se(I)&&typeof I.then=="function"&&(!R||typeof I.catch=="function")}function f(I){return me.call(I).slice(8,-1)}function V(I,R){if(!I||P(I)!=="object")return!1;var F=we(I);if(!F)return R===null;var A=xe.call(F,"constructor")&&F.constructor;return typeof A!="function"?R===null:R===A||R!==null&&Ot.call(A)===Ot.call(R)||typeof R=="function"&&typeof A.__typeson__type__=="string"&&A.__typeson__type__===R.__typeson__type__}function B(I){if(!I||f(I)!=="Object")return!1;var R=we(I);return R?V(I,Object):!0}function Te(I){if(!I||f(I)!=="Object")return!1;var R=we(I);return R?V(I,Object)||Te(R):!0}function Se(I){return I&&P(I)==="object"}function Ue(I){return I.replace(/~/g,"~0").replace(/\./g,"~1")}function Je(I){return I.replace(/~1/g,".").replace(/~0/g,"~")}function ct(I,R){if(R==="")return I;var F=R.indexOf(".");if(F>-1){var A=I[Je(R.slice(0,F))];return A===void 0?void 0:ct(A,R.slice(F+1))}return I[Je(R)]}function lt(I,R,F){if(R==="")return F;var A=R.indexOf(".");if(A>-1){var Q=I[Je(R.slice(0,A))];return lt(Q,R.slice(A+1),F)}return I[Je(R)]=F,I}function ut(I){return I===null?"null":Array.isArray(I)?"array":P(I)}var Ne=Object.keys,He=Array.isArray,it={}.hasOwnProperty,Dt=["type","replaced","iterateIn","iterateUnsetNumeric"];function ve(I,R){if(I.keypath==="")return-1;var F=I.keypath.match(/\./g)||0,A=R.keypath.match(/\./g)||0;return F&&(F=F.length),A&&(A=A.length),F>A?-1:F<A?1:I.keypath<R.keypath?-1:I.keypath>R.keypath}var ze=(function(){function I(R){k(this,I),this.options=R,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return J(I,[{key:"stringify",value:function(F,A,Q,ae){ae=ee({},this.options,{},ae,{stringification:!0});var Ee=this.encapsulate(F,null,ae);return He(Ee)?JSON.stringify(Ee[0],A,Q):Ee.then(function(Ce){return JSON.stringify(Ce,A,Q)})}},{key:"stringifySync",value:function(F,A,Q,ae){return this.stringify(F,A,Q,ee({throwOnBadSyncType:!0},ae,{sync:!0}))}},{key:"stringifyAsync",value:function(F,A,Q,ae){return this.stringify(F,A,Q,ee({throwOnBadSyncType:!0},ae,{sync:!1}))}},{key:"parse",value:function(F,A,Q){return Q=ee({},this.options,{},Q,{parse:!0}),this.revive(JSON.parse(F,A),Q)}},{key:"parseSync",value:function(F,A,Q){return this.parse(F,A,ee({throwOnBadSyncType:!0},Q,{sync:!0}))}},{key:"parseAsync",value:function(F,A,Q){return this.parse(F,A,ee({throwOnBadSyncType:!0},Q,{sync:!1}))}},{key:"specialTypeNames",value:function(F,A){var Q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Q.returnTypeNames=!0,this.encapsulate(F,A,Q)}},{key:"rootTypeName",value:function(F,A){var Q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Q.iterateNone=!0,this.encapsulate(F,A,Q)}},{key:"encapsulate",value:function(F,A,Q){Q=ee({sync:!0},this.options,{},Q);var ae=Q,Ee=ae.sync,Ce=this,fe={},mt=[],kt=[],Ct=[],Ft="cyclic"in Q?Q.cyclic:!0,It=Q,dt=It.encapsulateObserver,Pt=Ie("",F,Ft,A||{},Ct);function xt(le){var c=Object.values(fe);if(Q.iterateNone)return c.length?c[0]:I.getJSONType(le);if(c.length){if(Q.returnTypeNames)return qe(new Set(c));!le||!B(le)||it.call(le,"$types")?le={$:le,$types:{$:fe}}:le.$types=fe}else Se(le)&&it.call(le,"$types")&&(le={$:le,$types:!0});return Q.returnTypeNames?!1:le}function ot(le,c){return De.apply(this,arguments)}function De(){return De=$(regeneratorRuntime.mark(function le(c,o){var s;return regeneratorRuntime.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,Promise.all(o.map(function(Y){return Y[1].p}));case 2:return s=_.sent,_.next=5,Promise.all(s.map((function(){var Y=$(regeneratorRuntime.mark(function C(pe){var Z,de,D,Ae,Ve,Be,Ke,Ge,We,Oe,at,ie,z,he;return regeneratorRuntime.wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:if(Z=[],de=o.splice(0,1),D=te(de,1),Ae=D[0],Ve=te(Ae,7),Be=Ve[0],Ke=Ve[2],Ge=Ve[3],We=Ve[4],Oe=Ve[5],at=Ve[6],ie=Ie(Be,pe,Ke,Ge,Z,!0,at),z=V(ie,se),!(Be&&z)){oe.next=11;break}return oe.next=8,ie.p;case 8:return he=oe.sent,We[Oe]=he,oe.abrupt("return",ot(c,Z));case 11:return Be?We[Oe]=ie:z?c=ie.p:c=ie,oe.abrupt("return",ot(c,Z));case 13:case"end":return oe.stop()}},C)}));return function(C){return Y.apply(this,arguments)}})()));case 5:return _.abrupt("return",c);case 6:case"end":return _.stop()}},le)})),De.apply(this,arguments)}function _e(le,c,o){Object.assign(le,c);var s=Dt.map(function(p){var _=le[p];return delete le[p],_});o(),Dt.forEach(function(p,_){le[p]=s[_]})}function Ie(le,c,o,s,p,_,Y){var C,pe={},Z=P(c),de=dt?function(z){var he=Y||s.type||I.getJSONType(c);dt(Object.assign(z||pe,{keypath:le,value:c,cyclic:o,stateObj:s,promisesData:p,resolvingTypesonPromise:_,awaitingTypesonPromise:V(c,se)},{type:he}))}:null;if(["string","boolean","number","undefined"].includes(Z))return c===void 0||Z==="number"&&(isNaN(c)||c===-1/0||c===1/0)?(s.replaced?C=c:C=tt(le,c,s,p,!1,_,de),C!==c&&(pe={replaced:C})):C=c,de&&de(),C;if(c===null)return de&&de(),c;if(o&&!s.iterateIn&&!s.iterateUnsetNumeric&&c&&P(c)==="object"){var D=mt.indexOf(c);if(D<0)o===!0&&(mt.push(c),kt.push(le));else return fe[le]="#",de&&de({cyclicKeypath:kt[D]}),"#"+kt[D]}var Ae=B(c),Ve=He(c),Be=(Ae||Ve)&&(!Ce.plainObjectReplacers.length||s.replaced)||s.iterateIn?c:tt(le,c,s,p,Ae||Ve,null,de),Ke;if(Be!==c?(C=Be,pe={replaced:Be}):le===""&&V(c,se)?(p.push([le,c,o,s,void 0,void 0,s.type]),C=c):Ve&&s.iterateIn!=="object"||s.iterateIn==="array"?(Ke=new Array(c.length),pe={clone:Ke}):!["function","symbol"].includes(P(c))&&!("toJSON"in c)&&!V(c,se)&&!V(c,Promise)&&!V(c,ArrayBuffer)||Ae||s.iterateIn==="object"?(Ke={},s.addLength&&(Ke.length=c.length),pe={clone:Ke}):C=c,de&&de(),Q.iterateNone)return Ke||C;if(!Ke)return C;if(s.iterateIn){var Ge=function(he){var X={ownKeys:it.call(c,he)};_e(s,X,function(){var oe=le+(le?".":"")+Ue(he),Pe=Ie(oe,c[he],!!o,s,p,_);V(Pe,se)?p.push([oe,Pe,!!o,s,Ke,he,s.type]):Pe!==void 0&&(Ke[he]=Pe)})};for(var We in c)Ge(We);de&&de({endIterateIn:!0,end:!0})}else Ne(c).forEach(function(z){var he=le+(le?".":"")+Ue(z),X={ownKeys:!0};_e(s,X,function(){var oe=Ie(he,c[z],!!o,s,p,_);V(oe,se)?p.push([he,oe,!!o,s,Ke,z,s.type]):oe!==void 0&&(Ke[z]=oe)})}),de&&de({endIterateOwn:!0,end:!0});if(s.iterateUnsetNumeric){for(var Oe=c.length,at=function(he){if(!(he in c)){var X=le+(le?".":"")+he,oe={ownKeys:!1};_e(s,oe,function(){var Pe=Ie(X,void 0,!!o,s,p,_);V(Pe,se)?p.push([X,Pe,!!o,s,Ke,he,s.type]):Pe!==void 0&&(Ke[he]=Pe)})}},ie=0;ie<Oe;ie++)at(ie);de&&de({endIterateUnsetNumeric:!0,end:!0})}return Ke}function tt(le,c,o,s,p,_,Y){for(var C=p?Ce.plainObjectReplacers:Ce.nonplainObjectReplacers,pe=C.length;pe--;){var Z=C[pe];if(Z.test(c,o)){var de=Z.type;if(Ce.revivers[de]){var D=fe[le];fe[le]=D?[de].concat(D):de}if(Object.assign(o,{type:de,replaced:!0}),(Ee||!Z.replaceAsync)&&!Z.replace)return Y&&Y({typeDetected:!0}),Ie(le,c,Ft&&"readonly",o,s,_,de);Y&&Y({replacing:!0});var Ae=Ee||!Z.replaceAsync?"replace":"replaceAsync";return Ie(le,Z[Ae](c,o),Ft&&"readonly",o,s,_,de)}}return c}return Ct.length?Ee&&Q.throwOnBadSyncType?(function(){throw new TypeError("Sync method requested but async result obtained")})():Promise.resolve(ot(Pt,Ct)).then(xt):!Ee&&Q.throwOnBadSyncType?(function(){throw new TypeError("Async method requested but sync result obtained")})():Q.stringification&&Ee?[xt(Pt)]:Ee?xt(Pt):Promise.resolve(xt(Pt))}},{key:"encapsulateSync",value:function(F,A,Q){return this.encapsulate(F,A,ee({throwOnBadSyncType:!0},Q,{sync:!0}))}},{key:"encapsulateAsync",value:function(F,A,Q){return this.encapsulate(F,A,ee({throwOnBadSyncType:!0},Q,{sync:!1}))}},{key:"revive",value:function(F,A){var Q=F&&F.$types;if(!Q)return F;if(Q===!0)return F.$;A=ee({sync:!0},this.options,{},A);var ae=A,Ee=ae.sync,Ce=[],fe={},mt=!0;Q.$&&B(Q.$)&&(F=F.$,Q=Q.$,mt=!1);var kt=this;function Ct(De,_e){var Ie=kt.revivers[De]||[],tt=te(Ie,1),le=tt[0];if(!le)throw new Error("Unregistered type: "+De);return Ee&&!("revive"in le)?_e:le[Ee&&le.revive?"revive":!Ee&&le.reviveAsync?"reviveAsync":"revive"](_e,fe)}function Ft(){var De=[];if(Object.entries(Q).forEach(function(_e){var Ie=te(_e,2),tt=Ie[0],le=Ie[1];le!=="#"&&[].concat(le).forEach(function(c){var o=kt.revivers[c]||[null,{}],s=te(o,2),p=s[1].plain;p&&(De.push({keypath:tt,type:c}),delete Q[tt])})}),!!De.length)return De.sort(ve).reduce(function _e(Ie,tt){var le=tt.keypath,c=tt.type;if(j(Ie))return Ie.then(function(p){return _e(p,{keypath:le,type:c})});var o=ct(F,le);if(o=Ct(c,o),V(o,se))return o.then(function(p){var _=lt(F,le,p);_===p&&(F=_)});var s=lt(F,le,o);s===o&&(F=s)},void 0)}var It=[];function dt(De,_e,Ie,tt,le){if(!(mt&&De==="$types")){var c=Q[De],o=He(_e);if(o||B(_e)){var s=o?new Array(_e.length):{};for(Ne(_e).forEach(function(D){var Ae=dt(De+(De?".":"")+Ue(D),_e[D],Ie||s,s,D),Ve=function(Ke){return V(Ke,vt)?s[D]=void 0:Ke!==void 0&&(s[D]=Ke),Ke};V(Ae,se)?It.push(Ae.then(function(Be){return Ve(Be)})):Ve(Ae)}),_e=s;Ce.length;){var p=te(Ce[0],4),_=p[0],Y=p[1],C=p[2],pe=p[3],Z=ct(_,Y);if(Z!==void 0)C[pe]=Z;else break;Ce.splice(0,1)}}if(!c)return _e;if(c==="#"){var de=ct(Ie,_e.slice(1));return de===void 0&&Ce.push([Ie,_e.slice(1),tt,le]),de}return[].concat(c).reduce(function D(Ae,Ve){return V(Ae,se)?Ae.then(function(Be){return D(Be,Ve)}):Ct(Ve,Ae)},_e)}}function Pt(De){return V(De,vt)?void 0:De}var xt=Ft(),ot;return V(xt,se)?ot=xt.then(function(){return F}):(ot=dt("",F,null),It.length&&(ot=se.resolve(ot).then(function(De){return se.all([De].concat(It))}).then(function(De){var _e=te(De,1),Ie=_e[0];return Ie}))),j(ot)?Ee&&A.throwOnBadSyncType?(function(){throw new TypeError("Sync method requested but async result obtained")})():V(ot,se)?ot.p.then(Pt):ot:!Ee&&A.throwOnBadSyncType?(function(){throw new TypeError("Async method requested but sync result obtained")})():Ee?Pt(ot):Promise.resolve(Pt(ot))}},{key:"reviveSync",value:function(F,A){return this.revive(F,ee({throwOnBadSyncType:!0},A,{sync:!0}))}},{key:"reviveAsync",value:function(F,A){return this.revive(F,ee({throwOnBadSyncType:!0},A,{sync:!1}))}},{key:"register",value:function(F,A){return A=A||{},[].concat(F).forEach(function Q(ae){var Ee=this;if(He(ae))return ae.map(function(Ce){return Q.call(Ee,Ce)});ae&&Ne(ae).forEach(function(Ce){if(Ce==="#")throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(I.JSON_TYPES.includes(Ce))throw new TypeError("Plain JSON object types are reserved as type names");var fe=ae[Ce],mt=fe&&fe.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,kt=mt.filter(function(Ie){return Ie.type===Ce});if(kt.length&&(mt.splice(mt.indexOf(kt[0]),1),delete this.revivers[Ce],delete this.types[Ce]),typeof fe=="function"){var Ct=fe;fe={test:function(tt){return tt&&tt.constructor===Ct},replace:function(tt){return ee({},tt)},revive:function(tt){return Object.assign(Object.create(Ct.prototype),tt)}}}else if(He(fe)){var Ft=fe,It=te(Ft,3),dt=It[0],Pt=It[1],xt=It[2];fe={test:dt,replace:Pt,revive:xt}}if(!(!fe||!fe.test)){var ot={type:Ce,test:fe.test.bind(fe)};fe.replace&&(ot.replace=fe.replace.bind(fe)),fe.replaceAsync&&(ot.replaceAsync=fe.replaceAsync.bind(fe));var De=typeof A.fallback=="number"?A.fallback:A.fallback?0:1/0;if(fe.testPlainObjects?this.plainObjectReplacers.splice(De,0,ot):this.nonplainObjectReplacers.splice(De,0,ot),fe.revive||fe.reviveAsync){var _e={};fe.revive&&(_e.revive=fe.revive.bind(fe)),fe.reviveAsync&&(_e.reviveAsync=fe.reviveAsync.bind(fe)),this.revivers[Ce]=[_e,{plain:fe.testPlainObjects}]}this.types[Ce]=fe}},this)},this),this}}]),I})(),vt=function I(){k(this,I)};return vt.__typeson__type__="TypesonUndefined",ze.Undefined=vt,ze.Promise=se,ze.isThenable=j,ze.toStringTag=f,ze.hasConstructorOf=V,ze.isObject=Se,ze.isPlainObject=B,ze.isUserObject=Te,ze.escapeKeyPathComponent=Ue,ze.unescapeKeyPathComponent=Je,ze.getByKeyPath=ct,ze.getJSONType=ut,ze.JSON_TYPES=["null","boolean","number","string","array","object"],ze}))}),Ii=wr(function(q,L){(function(P,N){q.exports=N()})(br,(function(){function P(c){return(P=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o})(c)}function N(c,o){if(!(c instanceof o))throw new TypeError("Cannot call a class as a function")}function $(c,o){for(var s=0;s<o.length;s++){var p=o[s];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(c,p.key,p)}}function k(c,o,s){return o in c?Object.defineProperty(c,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):c[o]=s,c}function w(c,o){var s=Object.keys(c);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(c);o&&(p=p.filter((function(_){return Object.getOwnPropertyDescriptor(c,_).enumerable}))),s.push.apply(s,p)}return s}function J(c){return(function(s){if(Array.isArray(s))return ce(s)})(c)||(function(s){if(typeof Symbol<"u"&&Symbol.iterator in Object(s))return Array.from(s)})(c)||(function(s,p){if(s){if(typeof s=="string")return ce(s,p);var _=Object.prototype.toString.call(s).slice(8,-1);if(_==="Object"&&s.constructor&&(_=s.constructor.name),_==="Map"||_==="Set")return Array.from(s);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return ce(s,p)}})(c)||(function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})()}function ce(c,o){(o==null||o>c.length)&&(o=c.length);for(var s=0,p=new Array(o);s<o;s++)p[s]=c[s];return p}function E(c){return(E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s})(c)}function ee(c,o){if(!(c instanceof o))throw new TypeError("Cannot call a class as a function")}function te(c,o){for(var s=0;s<o.length;s++){var p=o[s];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(c,p.key,p)}}function qe(c,o,s){return o in c?Object.defineProperty(c,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):c[o]=s,c}function Qe(c,o){var s=Object.keys(c);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(c);o&&(p=p.filter((function(_){return Object.getOwnPropertyDescriptor(c,_).enumerable}))),s.push.apply(s,p)}return s}function be(c){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?Qe(Object(s),!0).forEach((function(p){qe(c,p,s[p])})):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(s)):Qe(Object(s)).forEach((function(p){Object.defineProperty(c,p,Object.getOwnPropertyDescriptor(s,p))}))}return c}function ge(c,o){return(function(p){if(Array.isArray(p))return p})(c)||(function(p,_){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(p)))){var Y=[],C=!0,pe=!1,Z=void 0;try{for(var de,D=p[Symbol.iterator]();!(C=(de=D.next()).done)&&(Y.push(de.value),!_||Y.length!==_);C=!0);}catch(Ae){pe=!0,Z=Ae}finally{try{C||D.return==null||D.return()}finally{if(pe)throw Z}}return Y}})(c,o)||_t(c,o)||(function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})()}function Me(c){return(function(s){if(Array.isArray(s))return Xe(s)})(c)||(function(s){if(typeof Symbol<"u"&&Symbol.iterator in Object(s))return Array.from(s)})(c)||_t(c)||(function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})()}function _t(c,o){if(c){if(typeof c=="string")return Xe(c,o);var s=Object.prototype.toString.call(c).slice(8,-1);return s==="Object"&&c.constructor&&(s=c.constructor.name),s==="Map"||s==="Set"?Array.from(c):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?Xe(c,o):void 0}}function Xe(c,o){(o==null||o>c.length)&&(o=c.length);for(var s=0,p=new Array(o);s<o;s++)p[s]=c[s];return p}var se=function c(o){ee(this,c),this.p=new Promise(o)};se.__typeson__type__="TypesonPromise",typeof Symbol<"u"&&(se.prototype[Symbol.toStringTag]="TypesonPromise"),se.prototype.then=function(c,o){var s=this;return new se((function(p,_){s.p.then((function(Y){p(c?c(Y):Y)})).catch((function(Y){return o?o(Y):Promise.reject(Y)})).then(p,_)}))},se.prototype.catch=function(c){return this.then(null,c)},se.resolve=function(c){return new se((function(o){o(c)}))},se.reject=function(c){return new se((function(o,s){s(c)}))},["all","race"].forEach((function(c){se[c]=function(o){return new se((function(s,p){Promise[c](o.map((function(_){return _&&_.constructor&&_.constructor.__typeson__type__==="TypesonPromise"?_.p:_}))).then(s,p)}))}}));var pt={}.toString,me={}.hasOwnProperty,xe=Object.getPrototypeOf,we=me.toString;function Ot(c,o){return B(c)&&typeof c.then=="function"&&(!o||typeof c.catch=="function")}function j(c){return pt.call(c).slice(8,-1)}function f(c,o){if(!c||E(c)!=="object")return!1;var s=xe(c);if(!s)return o===null;var p=me.call(s,"constructor")&&s.constructor;return typeof p!="function"?o===null:o===p||o!==null&&we.call(p)===we.call(o)||typeof o=="function"&&typeof p.__typeson__type__=="string"&&p.__typeson__type__===o.__typeson__type__}function V(c){return!(!c||j(c)!=="Object")&&(!xe(c)||f(c,Object))}function B(c){return c&&E(c)==="object"}function Te(c){return c.replace(/~/g,"~0").replace(/\./g,"~1")}function Se(c){return c.replace(/~1/g,".").replace(/~0/g,"~")}function Ue(c,o){if(o==="")return c;var s=o.indexOf(".");if(s>-1){var p=c[Se(o.slice(0,s))];return p===void 0?void 0:Ue(p,o.slice(s+1))}return c[Se(o)]}function Je(c,o,s){if(o==="")return s;var p=o.indexOf(".");return p>-1?Je(c[Se(o.slice(0,p))],o.slice(p+1),s):(c[Se(o)]=s,c)}function ct(c,o,s){return s?o?o(c):c:(c&&c.then||(c=Promise.resolve(c)),o?c.then(o):c)}var lt=Object.keys,ut=Array.isArray,Ne={}.hasOwnProperty,He=["type","replaced","iterateIn","iterateUnsetNumeric"];function it(c){return function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];try{return Promise.resolve(c.apply(this,o))}catch(p){return Promise.reject(p)}}}function Dt(c,o){if(c.keypath==="")return-1;var s=c.keypath.match(/\./g)||0,p=o.keypath.match(/\./g)||0;return s&&(s=s.length),p&&(p=p.length),s>p?-1:s<p?1:c.keypath<o.keypath?-1:c.keypath>o.keypath}var ve=(function(){function c(o){ee(this,c),this.options=o,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return(function(s,p,_){return p&&te(s.prototype,p),s})(c,[{key:"stringify",value:function(s,p,_,Y){Y=be(be(be({},this.options),Y),{},{stringification:!0});var C=this.encapsulate(s,null,Y);return ut(C)?JSON.stringify(C[0],p,_):C.then((function(pe){return JSON.stringify(pe,p,_)}))}},{key:"stringifySync",value:function(s,p,_,Y){return this.stringify(s,p,_,be(be({throwOnBadSyncType:!0},Y),{},{sync:!0}))}},{key:"stringifyAsync",value:function(s,p,_,Y){return this.stringify(s,p,_,be(be({throwOnBadSyncType:!0},Y),{},{sync:!1}))}},{key:"parse",value:function(s,p,_){return _=be(be(be({},this.options),_),{},{parse:!0}),this.revive(JSON.parse(s,p),_)}},{key:"parseSync",value:function(s,p,_){return this.parse(s,p,be(be({throwOnBadSyncType:!0},_),{},{sync:!0}))}},{key:"parseAsync",value:function(s,p,_){return this.parse(s,p,be(be({throwOnBadSyncType:!0},_),{},{sync:!1}))}},{key:"specialTypeNames",value:function(s,p){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return _.returnTypeNames=!0,this.encapsulate(s,p,_)}},{key:"rootTypeName",value:function(s,p){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return _.iterateNone=!0,this.encapsulate(s,p,_)}},{key:"encapsulate",value:function(s,p,_){var Y=it((function(ie,z){return ct(Promise.all(z.map((function(he){return he[1].p}))),(function(he){return ct(Promise.all(he.map(it((function(X){var oe=!1,Pe=[],St=ge(z.splice(0,1),1),Ze=ge(St[0],7),bt=Ze[0],Bt=Ze[2],je=Ze[3],gt=Ze[4],Fe=Ze[5],Et=Ze[6],Tt=Oe(bt,X,Bt,je,Pe,!0,Et),yt=f(Tt,se);return(function(Vt,en){var Yt=Vt();return Yt&&Yt.then?Yt.then(en):en(Yt)})((function(){if(bt&&yt)return ct(Tt.p,(function(Kt){return gt[Fe]=Kt,oe=!0,Y(ie,Pe)}))}),(function(Kt){return oe?Kt:(bt?gt[Fe]=Tt:ie=yt?Tt.p:Tt,Y(ie,Pe))}))})))),(function(){return ie}))}))})),C=(_=be(be({sync:!0},this.options),_)).sync,pe=this,Z={},de=[],D=[],Ae=[],Ve=!("cyclic"in _)||_.cyclic,Be=_.encapsulateObserver,Ke=Oe("",s,Ve,p||{},Ae);function Ge(ie){var z=Object.values(Z);if(_.iterateNone)return z.length?z[0]:c.getJSONType(ie);if(z.length){if(_.returnTypeNames)return Me(new Set(z));ie&&V(ie)&&!Ne.call(ie,"$types")?ie.$types=Z:ie={$:ie,$types:{$:Z}}}else B(ie)&&Ne.call(ie,"$types")&&(ie={$:ie,$types:!0});return!_.returnTypeNames&&ie}function We(ie,z,he){Object.assign(ie,z);var X=He.map((function(oe){var Pe=ie[oe];return delete ie[oe],Pe}));he(),He.forEach((function(oe,Pe){ie[oe]=X[Pe]}))}function Oe(ie,z,he,X,oe,Pe,St){var Ze,bt={},Bt=E(z),je=Be?function(Nt){var rt=St||X.type||c.getJSONType(z);Be(Object.assign(Nt||bt,{keypath:ie,value:z,cyclic:he,stateObj:X,promisesData:oe,resolvingTypesonPromise:Pe,awaitingTypesonPromise:f(z,se)},{type:rt}))}:null;if(["string","boolean","number","undefined"].includes(Bt))return z===void 0||Number.isNaN(z)||z===Number.NEGATIVE_INFINITY||z===Number.POSITIVE_INFINITY?(Ze=X.replaced?z:at(ie,z,X,oe,!1,Pe,je))!==z&&(bt={replaced:Ze}):Ze=z,je&&je(),Ze;if(z===null)return je&&je(),z;if(he&&!X.iterateIn&&!X.iterateUnsetNumeric&&z&&E(z)==="object"){var gt=de.indexOf(z);if(!(gt<0))return Z[ie]="#",je&&je({cyclicKeypath:D[gt]}),"#"+D[gt];he===!0&&(de.push(z),D.push(ie))}var Fe,Et=V(z),Tt=ut(z),yt=(Et||Tt)&&(!pe.plainObjectReplacers.length||X.replaced)||X.iterateIn?z:at(ie,z,X,oe,Et||Tt,null,je);if(yt!==z?(Ze=yt,bt={replaced:yt}):ie===""&&f(z,se)?(oe.push([ie,z,he,X,void 0,void 0,X.type]),Ze=z):Tt&&X.iterateIn!=="object"||X.iterateIn==="array"?(Fe=new Array(z.length),bt={clone:Fe}):(["function","symbol"].includes(E(z))||"toJSON"in z||f(z,se)||f(z,Promise)||f(z,ArrayBuffer))&&!Et&&X.iterateIn!=="object"?Ze=z:(Fe={},X.addLength&&(Fe.length=z.length),bt={clone:Fe}),je&&je(),_.iterateNone)return Fe||Ze;if(!Fe)return Ze;if(X.iterateIn){var Kt=function(rt){var Ut={ownKeys:Ne.call(z,rt)};We(X,Ut,(function(){var Rt=ie+(ie?".":"")+Te(rt),zt=Oe(Rt,z[rt],!!he,X,oe,Pe);f(zt,se)?oe.push([Rt,zt,!!he,X,Fe,rt,X.type]):zt!==void 0&&(Fe[rt]=zt)}))};for(var Vt in z)Kt(Vt);je&&je({endIterateIn:!0,end:!0})}else lt(z).forEach((function(Nt){var rt=ie+(ie?".":"")+Te(Nt);We(X,{ownKeys:!0},(function(){var Ut=Oe(rt,z[Nt],!!he,X,oe,Pe);f(Ut,se)?oe.push([rt,Ut,!!he,X,Fe,Nt,X.type]):Ut!==void 0&&(Fe[Nt]=Ut)}))})),je&&je({endIterateOwn:!0,end:!0});if(X.iterateUnsetNumeric){for(var en=z.length,Yt=function(rt){if(!(rt in z)){var Ut=ie+(ie?".":"")+rt;We(X,{ownKeys:!1},(function(){var Rt=Oe(Ut,void 0,!!he,X,oe,Pe);f(Rt,se)?oe.push([Ut,Rt,!!he,X,Fe,rt,X.type]):Rt!==void 0&&(Fe[rt]=Rt)}))}},nt=0;nt<en;nt++)Yt(nt);je&&je({endIterateUnsetNumeric:!0,end:!0})}return Fe}function at(ie,z,he,X,oe,Pe,St){for(var Ze=oe?pe.plainObjectReplacers:pe.nonplainObjectReplacers,bt=Ze.length;bt--;){var Bt=Ze[bt];if(Bt.test(z,he)){var je=Bt.type;if(pe.revivers[je]){var gt=Z[ie];Z[ie]=gt?[je].concat(gt):je}return Object.assign(he,{type:je,replaced:!0}),!C&&Bt.replaceAsync||Bt.replace?(St&&St({replacing:!0}),Oe(ie,Bt[C||!Bt.replaceAsync?"replace":"replaceAsync"](z,he),Ve&&"readonly",he,X,Pe,je)):(St&&St({typeDetected:!0}),Oe(ie,z,Ve&&"readonly",he,X,Pe,je))}}return z}return Ae.length?C&&_.throwOnBadSyncType?(function(){throw new TypeError("Sync method requested but async result obtained")})():Promise.resolve(Y(Ke,Ae)).then(Ge):!C&&_.throwOnBadSyncType?(function(){throw new TypeError("Async method requested but sync result obtained")})():_.stringification&&C?[Ge(Ke)]:C?Ge(Ke):Promise.resolve(Ge(Ke))}},{key:"encapsulateSync",value:function(s,p,_){return this.encapsulate(s,p,be(be({throwOnBadSyncType:!0},_),{},{sync:!0}))}},{key:"encapsulateAsync",value:function(s,p,_){return this.encapsulate(s,p,be(be({throwOnBadSyncType:!0},_),{},{sync:!1}))}},{key:"revive",value:function(s,p){var _=s&&s.$types;if(!_)return s;if(_===!0)return s.$;var Y=(p=be(be({sync:!0},this.options),p)).sync,C=[],pe={},Z=!0;_.$&&V(_.$)&&(s=s.$,_=_.$,Z=!1);var de=this;function D(Ge,We){var Oe=ge(de.revivers[Ge]||[],1)[0];if(!Oe)throw new Error("Unregistered type: "+Ge);return Y&&!("revive"in Oe)?We:Oe[Y&&Oe.revive?"revive":!Y&&Oe.reviveAsync?"reviveAsync":"revive"](We,pe)}var Ae=[];function Ve(Ge){return f(Ge,ze)?void 0:Ge}var Be,Ke=(function(){var We=[];if(Object.entries(_).forEach((function(Oe){var at=ge(Oe,2),ie=at[0],z=at[1];z!=="#"&&[].concat(z).forEach((function(he){ge(de.revivers[he]||[null,{}],2)[1].plain&&(We.push({keypath:ie,type:he}),delete _[ie])}))})),We.length)return We.sort(Dt).reduce((function Oe(at,ie){var z=ie.keypath,he=ie.type;if(Ot(at))return at.then((function(Pe){return Oe(Pe,{keypath:z,type:he})}));var X=Ue(s,z);if(f(X=D(he,X),se))return X.then((function(Pe){var St=Je(s,z,Pe);St===Pe&&(s=St)}));var oe=Je(s,z,X);oe===X&&(s=oe)}),void 0)})();return f(Ke,se)?Be=Ke.then((function(){return s})):(Be=(function Ge(We,Oe,at,ie,z){if(!Z||We!=="$types"){var he=_[We],X=ut(Oe);if(X||V(Oe)){var oe=X?new Array(Oe.length):{};for(lt(Oe).forEach((function(Fe){var Et=Ge(We+(We?".":"")+Te(Fe),Oe[Fe],at||oe,oe,Fe),Tt=function(Kt){return f(Kt,ze)?oe[Fe]=void 0:Kt!==void 0&&(oe[Fe]=Kt),Kt};f(Et,se)?Ae.push(Et.then((function(yt){return Tt(yt)}))):Tt(Et)})),Oe=oe;C.length;){var Pe=ge(C[0],4),St=Pe[0],Ze=Pe[1],bt=Pe[2],Bt=Pe[3],je=Ue(St,Ze);if(je===void 0)break;bt[Bt]=je,C.splice(0,1)}}if(!he)return Oe;if(he==="#"){var gt=Ue(at,Oe.slice(1));return gt===void 0&&C.push([at,Oe.slice(1),ie,z]),gt}return[].concat(he).reduce((function Fe(Et,Tt){return f(Et,se)?Et.then((function(yt){return Fe(yt,Tt)})):D(Tt,Et)}),Oe)}})("",s,null),Ae.length&&(Be=se.resolve(Be).then((function(Ge){return se.all([Ge].concat(Ae))})).then((function(Ge){return ge(Ge,1)[0]})))),Ot(Be)?Y&&p.throwOnBadSyncType?(function(){throw new TypeError("Sync method requested but async result obtained")})():f(Be,se)?Be.p.then(Ve):Be:!Y&&p.throwOnBadSyncType?(function(){throw new TypeError("Async method requested but sync result obtained")})():Y?Ve(Be):Promise.resolve(Ve(Be))}},{key:"reviveSync",value:function(s,p){return this.revive(s,be(be({throwOnBadSyncType:!0},p),{},{sync:!0}))}},{key:"reviveAsync",value:function(s,p){return this.revive(s,be(be({throwOnBadSyncType:!0},p),{},{sync:!1}))}},{key:"register",value:function(s,p){return p=p||{},[].concat(s).forEach((function _(Y){var C=this;if(ut(Y))return Y.map((function(pe){return _.call(C,pe)}));Y&&lt(Y).forEach((function(pe){if(pe==="#")throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(c.JSON_TYPES.includes(pe))throw new TypeError("Plain JSON object types are reserved as type names");var Z=Y[pe],de=Z&&Z.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,D=de.filter((function(We){return We.type===pe}));if(D.length&&(de.splice(de.indexOf(D[0]),1),delete this.revivers[pe],delete this.types[pe]),typeof Z=="function"){var Ae=Z;Z={test:function(Oe){return Oe&&Oe.constructor===Ae},replace:function(Oe){return be({},Oe)},revive:function(Oe){return Object.assign(Object.create(Ae.prototype),Oe)}}}else if(ut(Z)){var Ve=ge(Z,3);Z={test:Ve[0],replace:Ve[1],revive:Ve[2]}}if(Z&&Z.test){var Be={type:pe,test:Z.test.bind(Z)};Z.replace&&(Be.replace=Z.replace.bind(Z)),Z.replaceAsync&&(Be.replaceAsync=Z.replaceAsync.bind(Z));var Ke=typeof p.fallback=="number"?p.fallback:p.fallback?0:Number.POSITIVE_INFINITY;if(Z.testPlainObjects?this.plainObjectReplacers.splice(Ke,0,Be):this.nonplainObjectReplacers.splice(Ke,0,Be),Z.revive||Z.reviveAsync){var Ge={};Z.revive&&(Ge.revive=Z.revive.bind(Z)),Z.reviveAsync&&(Ge.reviveAsync=Z.reviveAsync.bind(Z)),this.revivers[pe]=[Ge,{plain:Z.testPlainObjects}]}this.types[pe]=Z}}),this)}),this),this}}]),c})(),ze=function c(){ee(this,c)};ze.__typeson__type__="TypesonUndefined",ve.Undefined=ze,ve.Promise=se,ve.isThenable=Ot,ve.toStringTag=j,ve.hasConstructorOf=f,ve.isObject=B,ve.isPlainObject=V,ve.isUserObject=function c(o){if(!o||j(o)!=="Object")return!1;var s=xe(o);return!s||f(o,Object)||c(s)},ve.escapeKeyPathComponent=Te,ve.unescapeKeyPathComponent=Se,ve.getByKeyPath=Ue,ve.getJSONType=function(o){return o===null?"null":Array.isArray(o)?"array":E(o)},ve.JSON_TYPES=["null","boolean","number","string","array","object"];for(var vt={userObject:{test:function(o,s){return ve.isUserObject(o)},replace:function(o){return(function(p){for(var _=1;_<arguments.length;_++){var Y=arguments[_]!=null?arguments[_]:{};_%2?w(Object(Y),!0).forEach((function(C){k(p,C,Y[C])})):Object.getOwnPropertyDescriptors?Object.defineProperties(p,Object.getOwnPropertyDescriptors(Y)):w(Object(Y)).forEach((function(C){Object.defineProperty(p,C,Object.getOwnPropertyDescriptor(Y,C))}))}return p})({},o)},revive:function(o){return o}}},I=[{arrayNonindexKeys:{testPlainObjects:!0,test:function(o,s){return!!Array.isArray(o)&&(Object.keys(o).some((function(p){return String(Number.parseInt(p))!==p}))&&(s.iterateIn="object",s.addLength=!0),!0)},replace:function(o,s){return s.iterateUnsetNumeric=!0,o},revive:function(o){if(Array.isArray(o))return o;var s=[];return Object.keys(o).forEach((function(p){var _=o[p];s[p]=_})),s}}},{sparseUndefined:{test:function(o,s){return o===void 0&&s.ownKeys===!1},replace:function(o){return 0},revive:function(o){}}}],R={undef:{test:function(o,s){return o===void 0&&(s.ownKeys||!("ownKeys"in s))},replace:function(o){return 0},revive:function(o){return new ve.Undefined}}},F={StringObject:{test:function(o){return ve.toStringTag(o)==="String"&&P(o)==="object"},replace:function(o){return String(o)},revive:function(o){return new String(o)}},BooleanObject:{test:function(o){return ve.toStringTag(o)==="Boolean"&&P(o)==="object"},replace:function(o){return!!o},revive:function(o){return new Boolean(o)}},NumberObject:{test:function(o){return ve.toStringTag(o)==="Number"&&P(o)==="object"},replace:function(o){return Number(o)},revive:function(o){return new Number(o)}}},A=[{nan:{test:function(o){return Number.isNaN(o)},replace:function(o){return"NaN"},revive:function(o){return Number.NaN}}},{infinity:{test:function(o){return o===Number.POSITIVE_INFINITY},replace:function(o){return"Infinity"},revive:function(o){return Number.POSITIVE_INFINITY}}},{negativeInfinity:{test:function(o){return o===Number.NEGATIVE_INFINITY},replace:function(o){return"-Infinity"},revive:function(o){return Number.NEGATIVE_INFINITY}}}],Q={date:{test:function(o){return ve.toStringTag(o)==="Date"},replace:function(o){var s=o.getTime();return Number.isNaN(s)?"NaN":s},revive:function(o){return o==="NaN"?new Date(Number.NaN):new Date(o)}}},ae={regexp:{test:function(o){return ve.toStringTag(o)==="RegExp"},replace:function(o){return{source:o.source,flags:(o.global?"g":"")+(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.sticky?"y":"")+(o.unicode?"u":"")}},revive:function(o){var s=o.source,p=o.flags;return new RegExp(s,p)}}},Ee={map:{test:function(o){return ve.toStringTag(o)==="Map"},replace:function(o){return J(o.entries())},revive:function(o){return new Map(o)}}},Ce={set:{test:function(o){return ve.toStringTag(o)==="Set"},replace:function(o){return J(o.values())},revive:function(o){return new Set(o)}}},fe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",mt=new Uint8Array(256),kt=0;kt<fe.length;kt++)mt[fe.charCodeAt(kt)]=kt;var Ct=function(o,s,p){p==null&&(p=o.byteLength);for(var _=new Uint8Array(o,0,p),Y=_.length,C="",pe=0;pe<Y;pe+=3)C+=fe[_[pe]>>2],C+=fe[(3&_[pe])<<4|_[pe+1]>>4],C+=fe[(15&_[pe+1])<<2|_[pe+2]>>6],C+=fe[63&_[pe+2]];return Y%3==2?C=C.slice(0,-1)+"=":Y%3==1&&(C=C.slice(0,-2)+"=="),C},Ft=function(o){var s,p,_,Y,C=o.length,pe=.75*o.length,Z=0;o[o.length-1]==="="&&(pe--,o[o.length-2]==="="&&pe--);for(var de=new ArrayBuffer(pe),D=new Uint8Array(de),Ae=0;Ae<C;Ae+=4)s=mt[o.charCodeAt(Ae)],p=mt[o.charCodeAt(Ae+1)],_=mt[o.charCodeAt(Ae+2)],Y=mt[o.charCodeAt(Ae+3)],D[Z++]=s<<2|p>>4,D[Z++]=(15&p)<<4|_>>2,D[Z++]=(3&_)<<6|63&Y;return de},It={arraybuffer:{test:function(o){return ve.toStringTag(o)==="ArrayBuffer"},replace:function(o,s){s.buffers||(s.buffers=[]);var p=s.buffers.indexOf(o);return p>-1?{index:p}:(s.buffers.push(o),Ct(o))},revive:function(o,s){if(s.buffers||(s.buffers=[]),P(o)==="object")return s.buffers[o.index];var p=Ft(o);return s.buffers.push(p),p}}},dt=typeof self>"u"?br:self,Pt={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach((function(c){var o=c,s=dt[o];s&&(Pt[c.toLowerCase()]={test:function(_){return ve.toStringTag(_)===o},replace:function(_,Y){var C=_.buffer,pe=_.byteOffset,Z=_.length;Y.buffers||(Y.buffers=[]);var de=Y.buffers.indexOf(C);return de>-1?{index:de,byteOffset:pe,length:Z}:(Y.buffers.push(C),{encoded:Ct(C),byteOffset:pe,length:Z})},revive:function(_,Y){Y.buffers||(Y.buffers=[]);var C,pe=_.byteOffset,Z=_.length,de=_.encoded,D=_.index;return"index"in _?C=Y.buffers[D]:(C=Ft(de),Y.buffers.push(C)),new s(C,pe,Z)}})}));var xt={dataview:{test:function(o){return ve.toStringTag(o)==="DataView"},replace:function(o,s){var p=o.buffer,_=o.byteOffset,Y=o.byteLength;s.buffers||(s.buffers=[]);var C=s.buffers.indexOf(p);return C>-1?{index:C,byteOffset:_,byteLength:Y}:(s.buffers.push(p),{encoded:Ct(p),byteOffset:_,byteLength:Y})},revive:function(o,s){s.buffers||(s.buffers=[]);var p,_=o.byteOffset,Y=o.byteLength,C=o.encoded,pe=o.index;return"index"in o?p=s.buffers[pe]:(p=Ft(C),s.buffers.push(p)),new DataView(p,_,Y)}}},ot={IntlCollator:{test:function(o){return ve.hasConstructorOf(o,Intl.Collator)},replace:function(o){return o.resolvedOptions()},revive:function(o){return new Intl.Collator(o.locale,o)}},IntlDateTimeFormat:{test:function(o){return ve.hasConstructorOf(o,Intl.DateTimeFormat)},replace:function(o){return o.resolvedOptions()},revive:function(o){return new Intl.DateTimeFormat(o.locale,o)}},IntlNumberFormat:{test:function(o){return ve.hasConstructorOf(o,Intl.NumberFormat)},replace:function(o){return o.resolvedOptions()},revive:function(o){return new Intl.NumberFormat(o.locale,o)}}};function De(c){for(var o=new Uint8Array(c.length),s=0;s<c.length;s++)o[s]=c.charCodeAt(s);return o.buffer}var _e={file:{test:function(o){return ve.toStringTag(o)==="File"},replace:function(o){var s=new XMLHttpRequest;if(s.overrideMimeType("text/plain; charset=x-user-defined"),s.open("GET",URL.createObjectURL(o),!1),s.send(),s.status!==200&&s.status!==0)throw new Error("Bad File access: "+s.status);return{type:o.type,stringContents:s.responseText,name:o.name,lastModified:o.lastModified}},revive:function(o){var s=o.name,p=o.type,_=o.stringContents,Y=o.lastModified;return new File([De(_)],s,{type:p,lastModified:Y})},replaceAsync:function(o){return new ve.Promise((function(s,p){var _=new FileReader;_.addEventListener("load",(function(){s({type:o.type,stringContents:_.result,name:o.name,lastModified:o.lastModified})})),_.addEventListener("error",(function(){p(_.error)})),_.readAsBinaryString(o)}))}}},Ie={bigint:{test:function(o){return typeof o=="bigint"},replace:function(o){return String(o)},revive:function(o){return BigInt(o)}}},tt={bigintObject:{test:function(o){return P(o)==="object"&&ve.hasConstructorOf(o,BigInt)},replace:function(o){return String(o)},revive:function(o){return new Object(BigInt(o))}}},le={cryptokey:{test:function(o){return ve.toStringTag(o)==="CryptoKey"&&o.extractable},replaceAsync:function(o){return new ve.Promise((function(s,p){crypto.subtle.exportKey("jwk",o).catch((function(_){p(_)})).then((function(_){s({jwk:_,algorithm:o.algorithm,usages:o.usages})}))}))},revive:function(o){var s=o.jwk,p=o.algorithm,_=o.usages;return crypto.subtle.importKey("jwk",s,p,!0,_)}}};return[vt,R,I,F,A,Q,ae,{imagedata:{test:function(o){return ve.toStringTag(o)==="ImageData"},replace:function(o){return{array:J(o.data),width:o.width,height:o.height}},revive:function(o){return new ImageData(new Uint8ClampedArray(o.array),o.width,o.height)}}},{imagebitmap:{test:function(o){return ve.toStringTag(o)==="ImageBitmap"||o&&o.dataset&&o.dataset.toStringTag==="ImageBitmap"},replace:function(o){var s=document.createElement("canvas");return s.getContext("2d").drawImage(o,0,0),s.toDataURL()},revive:function(o){var s=document.createElement("canvas"),p=s.getContext("2d"),_=document.createElement("img");return _.addEventListener("load",(function(){p.drawImage(_,0,0)})),_.src=o,s},reviveAsync:function(o){var s=document.createElement("canvas"),p=s.getContext("2d"),_=document.createElement("img");return _.addEventListener("load",(function(){p.drawImage(_,0,0)})),_.src=o,createImageBitmap(s)}}},_e,{file:_e.file,filelist:{test:function(o){return ve.toStringTag(o)==="FileList"},replace:function(o){for(var s=[],p=0;p<o.length;p++)s[p]=o.item(p);return s},revive:function(o){return new((function(){function s(){N(this,s),this._files=arguments[0],this.length=this._files.length}return(function(_,Y,C){return Y&&$(_.prototype,Y),_})(s,[{key:"item",value:function(_){return this._files[_]}},{key:Symbol.toStringTag,get:function(){return"FileList"}}]),s})())(o)}}},{blob:{test:function(o){return ve.toStringTag(o)==="Blob"},replace:function(o){var s=new XMLHttpRequest;if(s.overrideMimeType("text/plain; charset=x-user-defined"),s.open("GET",URL.createObjectURL(o),!1),s.send(),s.status!==200&&s.status!==0)throw new Error("Bad Blob access: "+s.status);return{type:o.type,stringContents:s.responseText}},revive:function(o){var s=o.type,p=o.stringContents;return new Blob([De(p)],{type:s})},replaceAsync:function(o){return new ve.Promise((function(s,p){var _=new FileReader;_.addEventListener("load",(function(){s({type:o.type,stringContents:_.result})})),_.addEventListener("error",(function(){p(_.error)})),_.readAsBinaryString(o)}))}}}].concat(typeof Map=="function"?Ee:[],typeof Set=="function"?Ce:[],typeof ArrayBuffer=="function"?It:[],typeof Uint8Array=="function"?Pt:[],typeof DataView=="function"?xt:[],typeof Intl<"u"?ot:[],typeof crypto<"u"?le:[],typeof BigInt<"u"?[Ie,tt]:[])}))}),fn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",On=new Uint8Array(256);for(var Ln=0;Ln<fn.length;Ln++)On[fn.codePointAt(Ln)]=Ln;var gr=function(L,P,N){N==null&&(N=L.byteLength);for(var $=new Uint8Array(L,0,N),k=$.length,w="",J=0;J<k;J+=3)w+=fn[$[J]>>2],w+=fn[($[J]&3)<<4|$[J+1]>>4],w+=fn[($[J+1]&15)<<2|$[J+2]>>6],w+=fn[$[J+2]&63];return k%3===2?w=w.slice(0,-1)+"=":k%3===1&&(w=w.slice(0,-2)+"=="),w},ei=function(L){var P=L.length,N=L.length*.75,$=0,k,w,J,ce;L[L.length-1]==="="&&(N--,L[L.length-2]==="="&&N--);for(var E=new ArrayBuffer(N),ee=new Uint8Array(E),te=0;te<P;te+=4)k=On[L.codePointAt(te)],w=On[L.codePointAt(te+1)],J=On[L.codePointAt(te+2)],ce=On[L.codePointAt(te+3)],ee[$++]=k<<2|w>>4,ee[$++]=(w&15)<<4|J>>2,ee[$++]=(J&3)<<6|ce&63;return E},Bi=typeof self>"u"?global:self,ti={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(q){var L=q,P=Bi[L];P&&(ti[q.toLowerCase()+"2"]={test:function(N){return $n.toStringTag(N)===L},replace:function(N){var $=N.buffer,k=N.byteOffset,w=N.length;return{buffer:$,byteOffset:k,length:w}},revive:function(N){var $=N.buffer,k=N.byteOffset,w=N.length;return new P($,k,w)}})});var Ki={arraybuffer:{test:function(q){return $n.toStringTag(q)==="ArrayBuffer"},replace:function(q){return gr(q,0,q.byteLength)},revive:function(q){var L=ei(q);return L}}},Mt=new $n().register(Ii),Ri="FileReaderSync"in self,Vn=[],qn=0;Mt.register([Ki,ti,{blob2:{test:function(q){return $n.toStringTag(q)==="Blob"},replace:function(q){if(q.isClosed)throw new Error("The Blob is closed");if(Ri){var L=Zr(q,"binary"),P=gr(L,0,L.byteLength);return{type:q.type,data:P}}else{Vn.push(q);var N={type:q.type,data:{start:qn,end:qn+q.size}};return qn+=q.size,N}},finalize:function(q,L){q.data=gr(L,0,L.byteLength)},revive:function(q){var L=q.type,P=q.data;return new Blob([ei(P)],{type:L})}}}]);Mt.mustFinalize=function(){return Vn.length>0};Mt.finalize=function(q){return Zt(void 0,void 0,void 0,function(){var L,P,N,$,k,w,J,ce,E,ee,te,qe;return $t(this,function(Qe){switch(Qe.label){case 0:return[4,Xr(new Blob(Vn),"binary")];case 1:if(L=Qe.sent(),q){for(P=0,N=q;P<N.length;P++)if($=N[P],$.$types){k=$.$types,w=k.$,w&&(k=k.$);for(J in k)ce=k[J],E=Mt.types[ce],E&&E.finalize&&(ee=wt.getByKeyPath($,w?"$."+J:J),E.finalize(ee,L.slice((te=ee.data)===null||te===void 0?void 0:te.start,(qe=ee.data)===null||qe===void 0?void 0:qe.end)))}}return Vn=[],qn=0,[2]}})})};var Di=2e3;function Fi(q,L){return Zt(this,void 0,void 0,function(){function P(){return Zt(this,void 0,void 0,function(){var te,qe,Qe,be,ge,Me,_t,Xe,se,pt;return $t(this,function(me){switch(me.label){case 0:return[4,Promise.all($.map(function(xe){return xe.count()}))];case 1:te=me.sent(),te.forEach(function(xe,we){return w[we].rowCount=xe}),ee.totalRows=te.reduce(function(xe,we){return xe+we}),qe=JSON.stringify(ce,void 0,J?2:void 0),Qe=qe.lastIndexOf("]"),be=qe.substring(0,Qe),k.push(be),ge=L.filter,Me=L.transform,_t=function(xe){var we,Ot,j,f,V,B,Te,Se,Ue,Je,ct,lt;return $t(this,function(ut){switch(ut.label){case 0:we=q.table(xe),Ot=we.schema.primKey,j=!!Ot.keyPath,f=L.numRowsPerChunk||Di,V=j?{tableName:we.name,inbound:!0,rows:[]}:{tableName:we.name,inbound:!1,rows:[]},B=JSON.stringify(V,void 0,J?2:void 0),J&&(B=B.split(`
`).join(`
    `)),Te=B.lastIndexOf("]"),k.push(B.substring(0,Te)),Se=null,Ue=0,Je=!0,ct=function(){var Ne,He,it,Dt,ve,R,ze,vt,I,R;return $t(this,function(F){switch(F.label){case 0:return E&&wt.ignoreTransaction(function(){return E(ee)}),Ne=Se==null?we.limit(f):we.where(":id").above(Se).limit(f),[4,Ne.toArray()];case 1:return He=F.sent(),He.length===0?[2,"break"]:(Se!=null&&Ue>0&&(k.push(","),J&&k.push(`
      `)),Je=He.length===f,j?(it=ge?He.filter(function(A){return ge(xe,A)}):He,Dt=Me?it.map(function(A){return Me(xe,A).value}):it,ve=Dt.map(function(A){return Mt.encapsulate(A)}),Mt.mustFinalize()?[4,wt.waitFor(Mt.finalize(ve))]:[3,3]):[3,4]);case 2:F.sent(),F.label=3;case 3:return R=JSON.stringify(ve,void 0,J?2:void 0),J&&(R=R.split(`
`).join(`
      `)),k.push(new Blob([R.substring(1,R.length-1)])),Ue=Dt.length,Se=He.length>0?wt.getByKeyPath(He[He.length-1],Ot.keyPath):null,[3,8];case 4:return[4,Ne.primaryKeys()];case 5:return ze=F.sent(),vt=ze.map(function(A,Q){return[A,He[Q]]}),ge&&(vt=vt.filter(function(A){var Q=A[0],ae=A[1];return ge(xe,ae,Q)})),Me&&(vt=vt.map(function(A){var Q=A[0],ae=A[1],Ee=Me(xe,ae,Q);return[Ee.key,Ee.value]})),I=vt.map(function(A){return Mt.encapsulate(A)}),Mt.mustFinalize()?[4,wt.waitFor(Mt.finalize(I))]:[3,7];case 6:F.sent(),F.label=7;case 7:R=JSON.stringify(I,void 0,J?2:void 0),J&&(R=R.split(`
`).join(`
      `)),k.push(new Blob([R.substring(1,R.length-1)])),Ue=vt.length,Se=ze.length>0?ze[ze.length-1]:null,F.label=8;case 8:return ee.completedRows+=He.length,[2]}})},ut.label=1;case 1:return Je?[5,ct()]:[3,3];case 2:return lt=ut.sent(),lt==="break"?[3,3]:[3,1];case 3:return k.push(B.substr(Te)),ee.completedTables+=1,ee.completedTables<ee.totalTables&&k.push(","),[2]}})},Xe=0,se=w,me.label=2;case 2:return Xe<se.length?(pt=se[Xe].name,[5,_t(pt)]):[3,5];case 3:me.sent(),me.label=4;case 4:return Xe++,[3,2];case 5:return k.push(qe.substr(Qe)),ee.done=!0,E&&wt.ignoreTransaction(function(){return E(ee)}),[2]}})})}var N,$,k,w,J,ce,E,ee;return $t(this,function(te){switch(te.label){case 0:L=L||{},N=L.skipTables?L.skipTables:[],$=q.tables.filter(function(qe){return!N.includes(qe.name)}),k=[],w=$.map(function(qe){return{name:qe.name,schema:ji(qe),rowCount:0}}),J=L.prettyJson,ce={formatName:"dexie",formatVersion:1,data:{databaseName:q.name,databaseVersion:q.verno,tables:w,data:[]}},E=L.progressCallback,ee={done:!1,completedRows:0,completedTables:0,totalRows:NaN,totalTables:w.length},te.label=1;case 1:return te.trys.push([1,,6,7]),L.noTransaction?[4,P()]:[3,3];case 2:return te.sent(),[3,5];case 3:return[4,q.transaction("r",q.tables,P)];case 4:te.sent(),te.label=5;case 5:return[3,7];case 6:return Mt.finalize(),[7];case 7:return[2,new Blob(k,{type:"text/json"})]}})})}var Li=1,Ui={Stream:function(){}},qi=wr(function(q,L){(function(P){var N=typeof process=="object"&&Qr?Qr:self;P.parser=function(j){return new Qe(j)},P.CParser=Qe,P.CStream=ge,P.createStream=be,P.MAX_BUFFER_LENGTH=10*1024*1024,P.DEBUG=N.CDEBUG==="debug",P.INFO=N.CDEBUG==="debug"||N.CDEBUG==="info",P.EVENTS=["value","string","key","openobject","closeobject","openarray","closearray","error","end","ready"];var $={textNode:void 0,numberNode:""},k=P.EVENTS.filter(function(j){return j!=="error"&&j!=="end"}),w=0,J;P.STATE={BEGIN:w++,VALUE:w++,OPEN_OBJECT:w++,CLOSE_OBJECT:w++,OPEN_ARRAY:w++,CLOSE_ARRAY:w++,TEXT_ESCAPE:w++,STRING:w++,BACKSLASH:w++,END:w++,OPEN_KEY:w++,CLOSE_KEY:w++,TRUE:w++,TRUE2:w++,TRUE3:w++,FALSE:w++,FALSE2:w++,FALSE3:w++,FALSE4:w++,NULL:w++,NULL2:w++,NULL3:w++,NUMBER_DECIMAL_POINT:w++,NUMBER_DIGIT:w++};for(var ce in P.STATE)P.STATE[P.STATE[ce]]=ce;w=P.STATE;const E={tab:9,lineFeed:10,carriageReturn:13,space:32,doubleQuote:34,plus:43,comma:44,minus:45,period:46,_0:48,_9:57,colon:58,E:69,openBracket:91,backslash:92,closeBracket:93,a:97,b:98,e:101,f:102,l:108,n:110,r:114,s:115,t:116,u:117,openBrace:123,closeBrace:125};Object.create||(Object.create=function(j){function f(){this.__proto__=j}return f.prototype=j,new f}),Object.getPrototypeOf||(Object.getPrototypeOf=function(j){return j.__proto__}),Object.keys||(Object.keys=function(j){var f=[];for(var V in j)j.hasOwnProperty(V)&&f.push(V);return f});function ee(j){var f=Math.max(P.MAX_BUFFER_LENGTH,10),V=0;for(var B in $){var Te=j[B]===void 0?0:j[B].length;Te>f&&(B==="text"?closeText(j):me(j,"Max buffer length exceeded: "+B)),V=Math.max(V,Te)}j.bufferCheckPosition=P.MAX_BUFFER_LENGTH-V+j.position}function te(j){for(var f in $)j[f]=$[f]}var qe=/[\\"\n]/g;function Qe(j){if(!(this instanceof Qe))return new Qe(j);var f=this;te(f),f.bufferCheckPosition=P.MAX_BUFFER_LENGTH,f.q=f.c=f.p="",f.opt=j||{},f.closed=f.closedRoot=f.sawRoot=!1,f.tag=f.error=null,f.state=w.BEGIN,f.stack=new Array,f.position=f.column=0,f.line=1,f.slashed=!1,f.unicodeI=0,f.unicodeS=null,f.depth=0,Me(f,"onready")}Qe.prototype={end:function(){xe(this)},write:Ot,resume:function(){return this.error=null,this},close:function(){return this.write(null)}};try{J=Ui.Stream}catch{J=function(){}}function be(j){return new ge(j)}function ge(j){if(!(this instanceof ge))return new ge(j);this._parser=new Qe(j),this.writable=!0,this.readable=!0,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new Buffer(2),3:new Buffer(3),4:new Buffer(4)},this.string="";var f=this;J.apply(f),this._parser.onend=function(){f.emit("end")},this._parser.onerror=function(V){f.emit("error",V),f._parser.error=null},k.forEach(function(V){Object.defineProperty(f,"on"+V,{get:function(){return f._parser["on"+V]},set:function(B){if(!B)return f.removeAllListeners(V),f._parser["on"+V]=B,B;f.on(V,B)},enumerable:!0,configurable:!1})})}ge.prototype=Object.create(J.prototype,{constructor:{value:ge}}),ge.prototype.write=function(j){j=new Buffer(j);for(var f=0;f<j.length;f++){var V=j[f];if(this.bytes_remaining>0){for(var B=0;B<this.bytes_remaining;B++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+B]=j[B];this.string=this.temp_buffs[this.bytes_in_sequence].toString(),this.bytes_in_sequence=this.bytes_remaining=0,f=f+B-1,this._parser.write(this.string),this.emit("data",this.string);continue}if(this.bytes_remaining===0&&V>=128)if(V>=194&&V<=223&&(this.bytes_in_sequence=2),V>=224&&V<=239&&(this.bytes_in_sequence=3),V>=240&&V<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+f>j.length){for(var Te=0;Te<=j.length-1-f;Te++)this.temp_buffs[this.bytes_in_sequence][Te]=j[f+Te];return this.bytes_remaining=f+this.bytes_in_sequence-j.length,!0}else{this.string=j.slice(f,f+this.bytes_in_sequence).toString(),f=f+this.bytes_in_sequence-1,this._parser.write(this.string),this.emit("data",this.string);continue}for(var Se=f;Se<j.length&&!(j[Se]>=128);Se++);this.string=j.slice(f,Se).toString(),this._parser.write(this.string),this.emit("data",this.string),f=Se-1}},ge.prototype.end=function(j){return j&&j.length&&this._parser.write(j.toString()),this._parser.end(),!0},ge.prototype.on=function(j,f){var V=this;return!V._parser["on"+j]&&k.indexOf(j)!==-1&&(V._parser["on"+j]=function(){var B=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);B.splice(0,0,j),V.emit.apply(V,B)}),J.prototype.on.call(V,j,f)},ge.prototype.destroy=function(){te(this._parser),this.emit("close")};function Me(j,f,V){P.INFO&&console.log("-- emit",f,V),j[f]&&j[f](V)}function _t(j,f,V){Xe(j),Me(j,f,V)}function Xe(j,f){j.textNode=pt(j.opt,j.textNode),j.textNode!==void 0&&Me(j,f||"onvalue",j.textNode),j.textNode=void 0}function se(j){j.numberNode&&Me(j,"onvalue",parseFloat(j.numberNode)),j.numberNode=""}function pt(j,f){return f===void 0||(j.trim&&(f=f.trim()),j.normalize&&(f=f.replace(/\s+/g," "))),f}function me(j,f){return Xe(j),f+=`
Line: `+j.line+`
Column: `+j.column+`
Char: `+j.c,f=new Error(f),j.error=f,Me(j,"onerror",f),j}function xe(j){return(j.state!==w.VALUE||j.depth!==0)&&me(j,"Unexpected end"),Xe(j),j.c="",j.closed=!0,Me(j,"onend"),Qe.call(j,j.opt),j}function we(j){return j===E.carriageReturn||j===E.lineFeed||j===E.space||j===E.tab}function Ot(j){var f=this;if(this.error)throw this.error;if(f.closed)return me(f,"Cannot write after close. Assign an onready handler.");if(j===null)return xe(f);var V=0,B=j.charCodeAt(0),Te=f.p;for(P.DEBUG&&console.log("write -> ["+j+"]");B&&(Te=B,f.c=B=j.charCodeAt(V++),Te!==B?f.p=Te:Te=f.p,!!B);)switch(P.DEBUG&&console.log(V,B,P.STATE[f.state]),f.position++,B===E.lineFeed?(f.line++,f.column=0):f.column++,f.state){case w.BEGIN:B===E.openBrace?f.state=w.OPEN_OBJECT:B===E.openBracket?f.state=w.OPEN_ARRAY:we(B)||me(f,"Non-whitespace before {[.");continue;case w.OPEN_KEY:case w.OPEN_OBJECT:if(we(B))continue;if(f.state===w.OPEN_KEY)f.stack.push(w.CLOSE_KEY);else if(B===E.closeBrace){Me(f,"onopenobject"),this.depth++,Me(f,"oncloseobject"),this.depth--,f.state=f.stack.pop()||w.VALUE;continue}else f.stack.push(w.CLOSE_OBJECT);B===E.doubleQuote?f.state=w.STRING:me(f,'Malformed object key should start with "');continue;case w.CLOSE_KEY:case w.CLOSE_OBJECT:if(we(B))continue;f.state,w.CLOSE_KEY,B===E.colon?(f.state===w.CLOSE_OBJECT?(f.stack.push(w.CLOSE_OBJECT),Xe(f,"onopenobject"),this.depth++):Xe(f,"onkey"),f.state=w.VALUE):B===E.closeBrace?(_t(f,"oncloseobject"),this.depth--,f.state=f.stack.pop()||w.VALUE):B===E.comma?(f.state===w.CLOSE_OBJECT&&f.stack.push(w.CLOSE_OBJECT),Xe(f),f.state=w.OPEN_KEY):me(f,"Bad object");continue;case w.OPEN_ARRAY:case w.VALUE:if(we(B))continue;if(f.state===w.OPEN_ARRAY)if(Me(f,"onopenarray"),this.depth++,f.state=w.VALUE,B===E.closeBracket){Me(f,"onclosearray"),this.depth--,f.state=f.stack.pop()||w.VALUE;continue}else f.stack.push(w.CLOSE_ARRAY);B===E.doubleQuote?f.state=w.STRING:B===E.openBrace?f.state=w.OPEN_OBJECT:B===E.openBracket?f.state=w.OPEN_ARRAY:B===E.t?f.state=w.TRUE:B===E.f?f.state=w.FALSE:B===E.n?f.state=w.NULL:B===E.minus?f.numberNode+="-":E._0<=B&&B<=E._9?(f.numberNode+=String.fromCharCode(B),f.state=w.NUMBER_DIGIT):me(f,"Bad value");continue;case w.CLOSE_ARRAY:if(B===E.comma)f.stack.push(w.CLOSE_ARRAY),Xe(f,"onvalue"),f.state=w.VALUE;else if(B===E.closeBracket)_t(f,"onclosearray"),this.depth--,f.state=f.stack.pop()||w.VALUE;else{if(we(B))continue;me(f,"Bad array")}continue;case w.STRING:f.textNode===void 0&&(f.textNode="");var Se=V-1,Ue=f.slashed,Je=f.unicodeI;e:for(;;){for(P.DEBUG&&console.log(V,B,P.STATE[f.state],Ue);Je>0;)if(f.unicodeS+=String.fromCharCode(B),B=j.charCodeAt(V++),f.position++,Je===4?(f.textNode+=String.fromCharCode(parseInt(f.unicodeS,16)),Je=0,Se=V-1):Je++,!B)break e;if(B===E.doubleQuote&&!Ue){f.state=f.stack.pop()||w.VALUE,f.textNode+=j.substring(Se,V-1),f.position+=V-1-Se;break}if(B===E.backslash&&!Ue&&(Ue=!0,f.textNode+=j.substring(Se,V-1),f.position+=V-1-Se,B=j.charCodeAt(V++),f.position++,!B))break;if(Ue){if(Ue=!1,B===E.n?f.textNode+=`
`:B===E.r?f.textNode+="\r":B===E.t?f.textNode+="	":B===E.f?f.textNode+="\f":B===E.b?f.textNode+="\b":B===E.u?(Je=1,f.unicodeS=""):f.textNode+=String.fromCharCode(B),B=j.charCodeAt(V++),f.position++,Se=V-1,B)continue;break}qe.lastIndex=V;var ct=qe.exec(j);if(ct===null){V=j.length+1,f.textNode+=j.substring(Se,V-1),f.position+=V-1-Se;break}if(V=ct.index+1,B=j.charCodeAt(ct.index),!B){f.textNode+=j.substring(Se,V-1),f.position+=V-1-Se;break}}f.slashed=Ue,f.unicodeI=Je;continue;case w.TRUE:B===E.r?f.state=w.TRUE2:me(f,"Invalid true started with t"+B);continue;case w.TRUE2:B===E.u?f.state=w.TRUE3:me(f,"Invalid true started with tr"+B);continue;case w.TRUE3:B===E.e?(Me(f,"onvalue",!0),f.state=f.stack.pop()||w.VALUE):me(f,"Invalid true started with tru"+B);continue;case w.FALSE:B===E.a?f.state=w.FALSE2:me(f,"Invalid false started with f"+B);continue;case w.FALSE2:B===E.l?f.state=w.FALSE3:me(f,"Invalid false started with fa"+B);continue;case w.FALSE3:B===E.s?f.state=w.FALSE4:me(f,"Invalid false started with fal"+B);continue;case w.FALSE4:B===E.e?(Me(f,"onvalue",!1),f.state=f.stack.pop()||w.VALUE):me(f,"Invalid false started with fals"+B);continue;case w.NULL:B===E.u?f.state=w.NULL2:me(f,"Invalid null started with n"+B);continue;case w.NULL2:B===E.l?f.state=w.NULL3:me(f,"Invalid null started with nu"+B);continue;case w.NULL3:B===E.l?(Me(f,"onvalue",null),f.state=f.stack.pop()||w.VALUE):me(f,"Invalid null started with nul"+B);continue;case w.NUMBER_DECIMAL_POINT:B===E.period?(f.numberNode+=".",f.state=w.NUMBER_DIGIT):me(f,"Leading zero not followed by .");continue;case w.NUMBER_DIGIT:E._0<=B&&B<=E._9?f.numberNode+=String.fromCharCode(B):B===E.period?(f.numberNode.indexOf(".")!==-1&&me(f,"Invalid number has two dots"),f.numberNode+="."):B===E.e||B===E.E?((f.numberNode.indexOf("e")!==-1||f.numberNode.indexOf("E")!==-1)&&me(f,"Invalid number has two exponential"),f.numberNode+="e"):B===E.plus||B===E.minus?(Te===E.e||Te===E.E||me(f,"Invalid symbol in number"),f.numberNode+=String.fromCharCode(B)):(se(f),V--,f.state=f.stack.pop()||w.VALUE);continue;default:me(f,"Unknown state: "+f.state)}return f.position>=f.bufferCheckPosition&&ee(f),f}})(L)});function Mi(q){var L=0,P=Vi(),N={pullAsync:function($){return Zt(this,void 0,void 0,function(){var k,w,J;return $t(this,function(ce){switch(ce.label){case 0:return k=q.slice(L,L+$),L+=$,[4,Xr(k,"text")];case 1:return w=ce.sent(),J=P.write(w),N.result=J||{},[2,J]}})})},pullSync:function($){var k=q.slice(L,L+$);L+=$;var w=Zr(k,"text"),J=P.write(w);return N.result=J||{},J},done:function(){return P.done()},eof:function(){return L>=q.size},result:{}};return N}function Vi(q){var L=qi.parser(),P=0,N,$=[],k,w,J=!1,ce=!1;return L.onopenobject=function(E){var ee={};ee.incomplete=!0,N||(N=ee),k&&($.push([w,k,ce]),ce?k.push(ee):k[w]=ee),k=ee,w=E,ce=!1,++P},L.onkey=function(E){return w=E},L.onvalue=function(E){return ce?k.push(E):k[w]=E},L.oncloseobject=function(){var E;delete k.incomplete,w=null,--P===0?J=!0:(E=$.pop(),w=E[0],k=E[1],ce=E[2])},L.onopenarray=function(){var E=[];E.incomplete=!0,N||(N=E),k&&($.push([w,k,ce]),ce?k.push(E):k[w]=E),k=E,ce=!0,w=null,++P},L.onclosearray=function(){var E;delete k.incomplete,w=null,--P===0?J=!0:(E=$.pop(),w=E[0],k=E[1],ce=E[2])},{write:function(E){return L.write(E),N},done:function(){return J}}}var ni=1024;function $i(q,L){return Zt(this,void 0,void 0,function(){var P,N,$,k;return $t(this,function(w){switch(w.label){case 0:return L=L||{},P=L.chunkSizeBytes||ni*1024,[4,ii(q,P)];case 1:return N=w.sent(),$=N.result.data,k=new wt(L.name!==void 0?L.name:$.databaseName),k.version($.databaseVersion).stores(Ci($)),[4,ri(k,N,L.name!==void 0?Mn(Mn({},L),{acceptNameDiff:!0}):L)];case 2:return w.sent(),[2,k]}})})}function ri(q,L,P){return Zt(this,void 0,void 0,function(){function N(){return Zt(this,void 0,void 0,function(){var ge,Me,_t,Xe,se;return $t(this,function(pt){switch(pt.label){case 0:ge=function(me){var xe,we,Ot,j,f,V,B,Te,Se,Ue,Je,ct,lt;return $t(this,function(ut){switch(ut.label){case 0:if(E.includes(me.tableName))return[2,"continue"];if(!me.rows)return[2,"break"];if(!me.rows.incomplete&&me.rows.length===0)return[2,"continue"];if(ee&&wt.ignoreTransaction(function(){return ee(te)}),xe=me.tableName,we=q.table(xe),Ot=ce.tables.filter(function(Ne){return Ne.name===xe})[0].schema,!we){if(P.acceptMissingTables)return[2,"continue"];throw new Error("Exported table ".concat(me.tableName," is missing in installed database"))}if(!P.acceptChangedPrimaryKey&&Ot.split(",")[0]!=we.schema.primKey.src)throw new Error("Primary key differs for table ".concat(me.tableName,". "));for(j=me.rows,f=[],V=0;V<j.length&&(B=j[V],!B.incomplete);V++)f.push(Mt.revive(B));return Te=P.filter,Se=P.transform,Ue=Te?me.inbound?f.filter(function(Ne){return Te(xe,Ne)}):f.filter(function(Ne){var He=Ne[0],it=Ne[1];return Te(xe,it,He)}):f,Se&&(Ue=Ue.map(me.inbound?function(Ne){return Se(xe,Ne).value}:function(Ne){var He=Ne[0],it=Ne[1],Dt=Se(xe,it,He);return[Dt.key,Dt.value]})),Je=me.inbound?[void 0,Ue]:[Ue.map(function(Ne){return Ne[0]}),f.map(function(Ne){return Ne[1]})],ct=Je[0],lt=Je[1],P.overwriteValues?[4,we.bulkPut(lt,ct)]:[3,2];case 1:return ut.sent(),[3,4];case 2:return[4,we.bulkAdd(lt,ct)];case 3:ut.sent(),ut.label=4;case 4:return te.completedRows+=f.length,f.incomplete||(te.completedTables+=1),j.splice(0,f.length),[2]}})},Me=0,_t=ce.data,pt.label=1;case 1:return Me<_t.length?(Xe=_t[Me],[5,ge(Xe)]):[3,4];case 2:if(se=pt.sent(),se==="break")return[3,4];pt.label=3;case 3:return Me++,[3,1];case 4:for(;ce.data.length>0&&ce.data[0].rows&&!ce.data[0].rows.incomplete;)ce.data.splice(0,1);return!k.done()&&!k.eof()?J?(k.pullSync($),[3,7]):[3,5]:[3,8];case 5:return[4,wt.waitFor(k.pullAsync($))];case 6:pt.sent(),pt.label=7;case 7:return[3,9];case 8:return[3,10];case 9:return[3,0];case 10:return[2]}})})}var $,k,w,J,ce,E,ee,te,qe,Qe,be;return $t(this,function(ge){switch(ge.label){case 0:return P=P||{},$=P.chunkSizeBytes||ni*1024,[4,ii(L,$)];case 1:if(k=ge.sent(),w=k.result,J="FileReaderSync"in self,ce=w.data,E=P.skipTables?P.skipTables:[],!P.acceptNameDiff&&q.name!==ce.databaseName)throw new Error("Name differs. Current database name is ".concat(q.name," but export is ").concat(ce.databaseName));if(!P.acceptVersionDiff&&q.verno!==ce.databaseVersion)throw new Error("Database version differs. Current database is in version ".concat(q.verno," but export is ").concat(ce.databaseVersion));if(ee=P.progressCallback,te={done:!1,completedRows:0,completedTables:0,totalRows:ce.tables.reduce(function(Me,_t){return Me+_t.rowCount},0),totalTables:ce.tables.length},ee&&wt.ignoreTransaction(function(){return ee(te)}),!P.clearTablesBeforeImport)return[3,5];qe=0,Qe=q.tables,ge.label=2;case 2:return qe<Qe.length?(be=Qe[qe],E.includes(be.name)?[3,4]:[4,be.clear()]):[3,5];case 3:ge.sent(),ge.label=4;case 4:return qe++,[3,2];case 5:return P.noTransaction?[4,N()]:[3,7];case 6:return ge.sent(),[3,9];case 7:return[4,q.transaction("rw",q.tables,N)];case 8:ge.sent(),ge.label=9;case 9:return te.done=!0,ee&&wt.ignoreTransaction(function(){return ee(te)}),[2]}})})}function ii(q,L){return Zt(this,void 0,void 0,function(){var P,N;return $t(this,function($){switch($.label){case 0:P="slice"in q?Mi(q):q,$.label=1;case 1:return P.eof()?[3,3]:[4,P.pullAsync(L)];case 2:return $.sent(),P.result.data&&P.result.data.data?[3,3]:[3,1];case 3:if(N=P.result,!N||N.formatName!="dexie")throw new Error("Given file is not a dexie export");if(N.formatVersion>Li)throw new Error("Format version ".concat(N.formatVersion," not supported"));if(!N.data)throw new Error("No data in export file");if(!N.data.databaseName)throw new Error("Missing databaseName in export file");if(!N.data.databaseVersion)throw new Error("Missing databaseVersion in export file");if(!N.data.tables)throw new Error("Missing tables in export file");return[2,P]}})})}wt.prototype.export=function(q){return Fi(this,q)};wt.prototype.import=function(q,L){return ri(this,q,L)};wt.import=function(q,L){return $i(q,L)};export{wt as D,Fi as e,$i as i,ro as u};
